<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><title>Installation &amp; Set-up - Palzin APM | Palzin APM</title><meta name="robots" content="index,follow"/><meta name="description" content="Connect your Laravel application with Ultimate."/><meta property="og:title" content="Installation &amp; Set-up"/><meta property="og:description" content="Connect your Laravel application with Ultimate."/><meta property="og:url" content="https://next-book.vercel.app"/><meta property="og:type" content="website"/><meta content="width=device-width, initial-scale=1.0, maximum-scale=5.0" name="viewport"/><link rel="icon" href="/favicon.ico"/><link rel="icon" href="/icon.svg" type="image/svg+xml"/><link rel="apple-touch-icon" href="/512.png"/><link rel="manifest" href="/manifest.json"/><meta name="next-head-count" content="13"/><link rel="preload" href="/_next/static/css/709efa2520de9399.css" as="style"/><link rel="stylesheet" href="/_next/static/css/709efa2520de9399.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-9b312e20a4e32339.js" defer=""></script><script src="/_next/static/chunks/framework-91d7f78b5b4003c8.js" defer=""></script><script src="/_next/static/chunks/main-83803dd478f5b5bc.js" defer=""></script><script src="/_next/static/chunks/pages/_app-1416bd64c72df7dd.js" defer=""></script><script src="/_next/static/chunks/239-8a9b2939eaea8e23.js" defer=""></script><script src="/_next/static/chunks/133-66f115dc05b5dc1c.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bpart%5D/%5Bpage%5D-c55eb70027a9402d.js" defer=""></script><script src="/_next/static/bTUou9AZlpBHxSxdWGLVM/_buildManifest.js" defer=""></script><script src="/_next/static/bTUou9AZlpBHxSxdWGLVM/_ssgManifest.js" defer=""></script><script src="/_next/static/bTUou9AZlpBHxSxdWGLVM/_middlewareManifest.js" defer=""></script></head><body class="bg-gray-200 dark:bg-gray-800 text-gray-700 dark:text-gray-200"><div id="__next" data-reactroot=""><header class="m-header z-40 md:shadow-md bg-gray-200 dark:bg-gray-800 fixed w-screen top-0 h-10 md:h-14 font-medium"><div class="logo-holder flex"><div class="flex pt-1 text-xs lg:text-sm nav-bar"><div class="flex ml-1 items-center md:hidden"><button title="Toggle mobile sidebar" class="shadow bg-gray-100 text-gray-600 dark:text-gray-400 dark:bg-gray-700 rounded p-1 focus:outline-none w-8 h-8"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg></button></div><div class="img-holder flex"><img src="/palzin-apm.png"/></div><nav class="text-left text-xs lg:text-sm pt-1 flex-auto space-x-1"><a class="border border-transparent hover:bg-gray-300 hover:text-gray-700 dark:hover:bg-gray-600
               dark:hover:text-gray-50 px-2 py-2 rounded-md font-medium hidden md:inline-block dark:text-gray-300 text-gray-600" href="/intro">Home</a><a class="border border-transparent hover:bg-gray-300 hover:text-gray-700 dark:hover:bg-gray-600
               dark:hover:text-gray-50 px-2 py-2 rounded-md font-medium hidden md:inline-block dark:text-gray-300 text-gray-600" href="/php/introduction">PHP</a><a class="border border-transparent hover:bg-gray-300 hover:text-gray-700 dark:hover:bg-gray-600
               dark:hover:text-gray-50 px-2 py-2 rounded-md font-medium hidden md:inline-block dark:bg-gray-700 dark:text-gray-50 bg-gray-300 text-gray-700" href="/laravel/introduction">Laravel/Lumen</a><a class="border border-transparent hover:bg-gray-300 hover:text-gray-700 dark:hover:bg-gray-600
               dark:hover:text-gray-50 px-2 py-2 rounded-md font-medium hidden md:inline-block dark:text-gray-300 text-gray-600" href="https://github.com/amiroff/NextBook">Github</a></nav><div class="flex items-center space-x-2"><button title="Toggle dark mode (T)" class="shadow bg-gray-100 text-gray-600 dark:text-gray-400 dark:bg-gray-700 rounded p-1 mr-1 md:mr-7 focus:outline-none w-8 h-8"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg></button></div></div></div></header><div class="content-wrapper mt-10 md:mt-14 flex xl:container xl:mx-auto"><aside class="sidebar z-50 flex-none md:w-56 xl:w-64 h-screen fixed top-10 md:top-14 hidden md:block"><div class="w-full pb-40 md:pb-16 h-full overflow-y-auto pr-6 "><div class="flex flex-col md:mt-10"><a aria-label="Palzin APM" href="/"><div class="flex flex-col items-center"><span class="hidden text-center md:inline-block font-semibold " title="Palzin APM">Palzin APM</span></div></a><div class="mt-6 pl-2 leading-loose tracking-wide"><div><a class="flex items-center font-normal pl-2 my-1 rounded hover:bg-gray-300 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-50" href="/intro"><span class="text-gray-500 dark:text-gray-300"><svg viewBox="0 0 16 16" fill="currentColor" class="w-3"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8z"></path></svg></span><span class="pl-2">Welcome to Palzin APM</span></a></div><div class="flex font-medium my-2 ml-2 items-center"><div class="text-gray-400 dark:text-gray-400"><svg height="16px" class="sidebar-title-icon" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></div><div class="pl-2 cursor-pointer select-none">PHP</div></div><div class="hidden"><a class="flex items-center font-normal pl-2 my-1 rounded hover:bg-gray-300 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-50" href="/php/introduction"><span class="text-gray-500 dark:text-gray-300"><svg viewBox="0 0 16 16" fill="currentColor" class="w-3"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8z"></path></svg></span><span class="pl-2">Introduction</span></a><a class="flex items-center font-normal pl-2 my-1 rounded hover:bg-gray-300 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-50" href="/php/upgrade-guide"><span class="text-gray-500 dark:text-gray-300"><svg viewBox="0 0 16 16" fill="currentColor" class="w-3"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8z"></path></svg></span><span class="pl-2">Upgrade Guide</span></a><a class="flex items-center font-normal pl-2 my-1 rounded hover:bg-gray-300 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-50" href="/php/install-guide"><span class="text-gray-500 dark:text-gray-300"><svg viewBox="0 0 16 16" fill="currentColor" class="w-3"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8z"></path></svg></span><span class="pl-2">Installation</span></a><a class="flex items-center font-normal pl-2 my-1 rounded hover:bg-gray-300 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-50" href="/php/usage"><span class="text-gray-500 dark:text-gray-300"><svg viewBox="0 0 16 16" fill="currentColor" class="w-3"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8z"></path></svg></span><span class="pl-2">Usage</span></a><a class="flex items-center font-normal pl-2 my-1 rounded hover:bg-gray-300 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-50" href="/php/configuration"><span class="text-gray-500 dark:text-gray-300"><svg viewBox="0 0 16 16" fill="currentColor" class="w-3"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8z"></path></svg></span><span class="pl-2">Configuration</span></a><a class="flex items-center font-normal pl-2 my-1 rounded hover:bg-gray-300 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-50" href="/php/custom-segment"><span class="text-gray-500 dark:text-gray-300"><svg viewBox="0 0 16 16" fill="currentColor" class="w-3"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8z"></path></svg></span><span class="pl-2">Custom Segments</span></a><a class="flex items-center font-normal pl-2 my-1 rounded hover:bg-gray-300 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-50" href="/php/exception"><span class="text-gray-500 dark:text-gray-300"><svg viewBox="0 0 16 16" fill="currentColor" class="w-3"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8z"></path></svg></span><span class="pl-2">Exceptions Monitoring</span></a></div><div class="flex font-medium my-2 ml-2 items-center"><div class="text-gray-400 dark:text-gray-400"><svg height="16px" class="sidebar-title-icon" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></div><div class="pl-2 cursor-pointer select-none">Laravel/Lumen</div></div><div class="hidden"><a class="flex items-center font-normal pl-2 my-1 rounded hover:bg-gray-300 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-50" href="/laravel/introduction"><span class="text-gray-500 dark:text-gray-300"><svg viewBox="0 0 16 16" fill="currentColor" class="w-3"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8z"></path></svg></span><span class="pl-2">Introduction</span></a><a class="flex items-center font-normal pl-2 my-1 rounded hover:bg-gray-300 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-50" href="/laravel/upgrade-guide"><span class="text-gray-500 dark:text-gray-300"><svg viewBox="0 0 16 16" fill="currentColor" class="w-3"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8z"></path></svg></span><span class="pl-2">Upgrade Guide</span></a><a class="flex items-center font-normal pl-2 my-1 rounded hover:bg-gray-300 dark:hover:bg-gray-700 text-gray-900 dark:text-gray-50 bg-gray-300 dark:bg-gray-700" href="/laravel/install-guide"><span class="text-gray-900 dark:text-gray-50"><svg viewBox="0 0 16 16" fill="currentColor" class="w-3"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8z"></path></svg></span><span class="pl-2">Installation</span></a><a class="flex items-center font-normal pl-2 my-1 rounded hover:bg-gray-300 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-50" href="/laravel/usage"><span class="text-gray-500 dark:text-gray-300"><svg viewBox="0 0 16 16" fill="currentColor" class="w-3"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8z"></path></svg></span><span class="pl-2">Http Requests Monitoring</span></a><a class="flex items-center font-normal pl-2 my-1 rounded hover:bg-gray-300 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-50" href="/laravel/configuration"><span class="text-gray-500 dark:text-gray-300"><svg viewBox="0 0 16 16" fill="currentColor" class="w-3"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8z"></path></svg></span><span class="pl-2">Configuration</span></a><a class="flex items-center font-normal pl-2 my-1 rounded hover:bg-gray-300 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-50" href="/laravel/exception"><span class="text-gray-500 dark:text-gray-300"><svg viewBox="0 0 16 16" fill="currentColor" class="w-3"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8z"></path></svg></span><span class="pl-2">Exceptions Monitoring</span></a></div></div></div></div></aside><div class="md-wrapper flex md:ml-56 xl:ml-64"><div class="content-container flex"><div class="content px-4 md:px-8 w-screen max-w-screen-sm md:max-w-screen-md xl:max-w-screen-md 2xl:max-w-screen-lg"><h1 class="text-4xl font-bold my-5">Installation &amp; Set-up</h1><p class="my-1">Connect your Laravel application with Ultimate.</p><div class="md-content"><hr class="my-3 mx-1 border-gray-300 dark:border-gray-600"/><div class="font-semibold my-5 text-3xl"><h3 id="server-requirements" class="inline-block">Server requirements</h3><span class="hidden md:inline-block m-1 text-sm 2xl:text-base cursor-pointer text-transparent hover:text-gray-400" title="Copy link to this heading" aria-hidden="true">¶</span></div><ul class="ml-6 list-outside list-disc leading-7"><li>PHP &gt;= 7.2</li><li>Laravel &gt;= 5.5</li></ul><p>To verify what version of PHP is installed on your server run this command in your terminal: <strong>php -v</strong></p><p>To know what is the Laravel version behind your application run this command in your application&#x27;s main directory: <strong>php artisan --version</strong></p><div class="font-semibold my-5 text-3xl"><h3 id="clear-the-laravel-configuration" class="inline-block">Clear the Laravel configuration</h3><span class="hidden md:inline-block m-1 text-sm 2xl:text-base cursor-pointer text-transparent hover:text-gray-400" title="Copy link to this heading" aria-hidden="true">¶</span></div><p>Before installing the package you should clear your Laravel configuration to avoid unexpected error loading the default package config file.</p><p>Run the command below to clear your cached configuration:</p><p><strong>php artisan config:clear</strong></p><div class="font-semibold my-5 text-3xl"><h3 id="install" class="inline-block">Install</h3><span class="hidden md:inline-block m-1 text-sm 2xl:text-base cursor-pointer text-transparent hover:text-gray-400" title="Copy link to this heading" aria-hidden="true">¶</span></div><p>Type the command below in your terminal to install the latest version of the package:</p><pre><div class="clean"><div class="relative h-0"><button class="no-print absolute top-1 right-1 rounded w-7 h-7 p-1 z-10 text-gray-500 dark:bg-gray-900 dark:text-gray-400 focus:outline-none" title="Copy to clipboard"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path></svg></button></div><pre class="text-sm 2xl:text-base overflow-x-auto py-3 my-4 
                           rounded dark:bg-gray-900 dark:text-gray-200
    bg-gray-50 text-gray-900 mt-4"><code class="" style="white-space:pre"><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">1</span><span>composer </span><span class="token token" style="color:#7c4dff">require</span><span> ingress</span><span class="token token" style="color:#39adb5">-</span><span>it</span><span class="token token" style="color:#39adb5">-</span><span>solutions</span><span class="token token" style="color:#39adb5">/</span><span>ultimate</span><span class="token token" style="color:#39adb5">-</span><span>laravel</span></span></code></pre></div></pre><div class="font-semibold my-5 text-3xl"><h3 id="for-lumen" class="inline-block">For Lumen</h3><span class="hidden md:inline-block m-1 text-sm 2xl:text-base cursor-pointer text-transparent hover:text-gray-400" title="Copy link to this heading" aria-hidden="true">¶</span></div><p>If your application is based on Lumen you need to manually register the UltimateServiceProvider:</p><pre><div class="clean"><div class="relative h-0"><button class="no-print absolute top-1 right-1 rounded w-7 h-7 p-1 z-10 text-gray-500 dark:bg-gray-900 dark:text-gray-400 focus:outline-none" title="Copy to clipboard"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path></svg></button></div><pre class="text-sm 2xl:text-base overflow-x-auto py-3 my-4 
                           rounded dark:bg-gray-900 dark:text-gray-200
    bg-gray-50 text-gray-900 mt-4"><code class="" style="white-space:pre"><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">1</span><span class="token token" style="color:#e53935">$app</span><span class="token token" style="color:#39adb5">-&gt;</span><span class="token token" style="color:#7c4dff">register</span><span class="token token" style="color:#39adb5">(</span><span class="token token class-name-fully-qualified static-context" style="color:#39adb5">\</span><span class="token token class-name-fully-qualified static-context" style="color:#6182b8">Ultimate</span><span class="token token class-name-fully-qualified static-context" style="color:#39adb5">\</span><span class="token token class-name-fully-qualified static-context" style="color:#6182b8">Laravel</span><span class="token token class-name-fully-qualified static-context" style="color:#39adb5">\</span><span class="token token class-name-fully-qualified static-context" style="color:#6182b8">UltimateServiceProvider</span><span class="token token" style="color:#39adb5">::</span><span class="token token" style="color:#7c4dff">class</span><span class="token token" style="color:#39adb5">)</span><span class="token token" style="color:#39adb5">;</span></span></code></pre></div></pre><p>If you wish to use the \Ultimate\Laravel\Facades\Ultimate facade, you should also enable facades if you did not already by uncommenting the withFacades() call in bootstrap/app.php:</p><pre><div class="clean"><div class="relative h-0"><button class="no-print absolute top-1 right-1 rounded w-7 h-7 p-1 z-10 text-gray-500 dark:bg-gray-900 dark:text-gray-400 focus:outline-none" title="Copy to clipboard"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path></svg></button></div><pre class="text-sm 2xl:text-base overflow-x-auto py-3 my-4 
                           rounded dark:bg-gray-900 dark:text-gray-200
    bg-gray-50 text-gray-900 mt-4"><code class="" style="white-space:pre"><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">1</span><span class="token token" style="color:#e53935">$app</span><span class="token token" style="color:#39adb5">-&gt;</span><span class="token token" style="color:#7c4dff">withFacades</span><span class="token token" style="color:#39adb5">(</span><span class="token token" style="color:#39adb5">)</span><span class="token token" style="color:#39adb5">;</span></span></code></pre></div></pre><div class="font-semibold my-5 text-3xl"><h3 id="configure-the-ingestion-key" class="inline-block">Configure the Ingestion Key</h3><span class="hidden md:inline-block m-1 text-sm 2xl:text-base cursor-pointer text-transparent hover:text-gray-400" title="Copy link to this heading" aria-hidden="true">¶</span></div><p>Get a new Ingestion Key by signing up for Palzin APM (<a href="https://app.ultimate.dev/register" target="_blank" rel="nofollow noopener noreferrer" class="underline">https://app.ultimate.dev/register</a>) and creating a new application.</p><p>Put the Palzin APM Ingestion Key in your environment file:</p><pre><div class="clean"><div class="relative h-0"><button class="no-print absolute top-1 right-1 rounded w-7 h-7 p-1 z-10 text-gray-500 dark:bg-gray-900 dark:text-gray-400 focus:outline-none" title="Copy to clipboard"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path></svg></button></div><pre class="text-sm 2xl:text-base overflow-x-auto py-3 my-4 
                           rounded dark:bg-gray-900 dark:text-gray-200
    bg-gray-50 text-gray-900 mt-4"><code class="" style="white-space:pre"><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">1</span><span class="token token" style="color:#7c4dff">ULTIMATE_INGESTION_KEY</span><span class="token token" style="color:#39adb5">=</span><span class="token token" style="color:#39adb5">[</span><span>ingestion key</span><span class="token token" style="color:#39adb5">]</span></span></code></pre></div></pre><div class="font-semibold my-5 text-3xl"><h3 id="test-everything-is-working" class="inline-block">Test everything is working</h3><span class="hidden md:inline-block m-1 text-sm 2xl:text-base cursor-pointer text-transparent hover:text-gray-400" title="Copy link to this heading" aria-hidden="true">¶</span></div><p>Execute the test command to check if your app can send data to Palzin APM correctly:</p><pre><div class="clean"><div class="relative h-0"><button class="no-print absolute top-1 right-1 rounded w-7 h-7 p-1 z-10 text-gray-500 dark:bg-gray-900 dark:text-gray-400 focus:outline-none" title="Copy to clipboard"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path></svg></button></div><pre class="text-sm 2xl:text-base overflow-x-auto py-3 my-4 
                           rounded dark:bg-gray-900 dark:text-gray-200
    bg-gray-50 text-gray-900 mt-4"><code class="" style="white-space:pre"><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">1</span><span>php artisan ultimate</span><span class="token token" style="color:#39adb5">:</span><span>test</span></span></code></pre></div></pre><p>Go to <a href="https://www.palzin.app/" target="_blank" rel="nofollow noopener noreferrer" class="underline">https://www.palzin.app/</a> to explore your data.</p><p>By default Palzin APM will monitor everything executed in background:</p><ul class="ml-6 list-outside list-disc leading-7"><li>Queued Jobs</li><li>Artisan commands</li><li>Unhandled Exceptions</li></ul><p class="hint tip">If you want learn more about background jobs monitoring take a look on our article: <a href="https://www.palzin.app/laravel-background-jobs-commands-monitoring-with-ultimate/" target="_blank" rel="nofollow noopener noreferrer" class="underline">https://www.palzin.app/laravel-background-jobs-commands-monitoring-with-ultimate/</a></p><p>Go the <a href="" class="underline">Http Request Monitoring</a> section to understand how to trace your application when it&#x27;s executed due to an incoming http request.</p><div class="font-semibold my-5 text-3xl"><h3 id="reporting-out-of-memory-errors" class="inline-block">Reporting Out Of Memory Errors</h3><span class="hidden md:inline-block m-1 text-sm 2xl:text-base cursor-pointer text-transparent hover:text-gray-400" title="Copy link to this heading" aria-hidden="true">¶</span></div><p>When your app runs out of memory it&#x27;s needed to temporary increase the PHP memory limit to ensure Palzin APM can report the current transaction. To do this, a “bootstrapper” class must be registered in both the app/Http/Kernel.php and app/Console/Kernel.php files:</p><pre><div class="clean"><div class="relative h-0"><button class="no-print absolute top-1 right-1 rounded w-7 h-7 p-1 z-10 text-gray-500 dark:bg-gray-900 dark:text-gray-400 focus:outline-none" title="Copy to clipboard"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path></svg></button></div><pre class="text-sm 2xl:text-base overflow-x-auto py-3 my-4 
                           rounded dark:bg-gray-900 dark:text-gray-200
    bg-gray-50 text-gray-900 mt-4"><code class="" style="white-space:pre"><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">1</span><span class="token token" style="color:#7c4dff">protected</span><span> </span><span class="token token" style="color:#7c4dff">function</span><span> </span><span class="token token function-definition" style="color:#7c4dff">bootstrappers</span><span class="token token" style="color:#39adb5">(</span><span class="token token" style="color:#39adb5">)</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">2</span><span></span><span class="token token" style="color:#39adb5">{</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">3</span><span>    </span><span class="token token" style="color:#7c4dff">return</span><span> </span><span class="token token" style="color:#7c4dff">array_merge</span><span class="token token" style="color:#39adb5">(</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">4</span><span>        </span><span class="token token" style="color:#39adb5">[</span><span class="token token class-name-fully-qualified static-context" style="color:#39adb5">\</span><span class="token token class-name-fully-qualified static-context" style="color:#6182b8">Ultimate</span><span class="token token class-name-fully-qualified static-context" style="color:#39adb5">\</span><span class="token token class-name-fully-qualified static-context" style="color:#6182b8">Laravel</span><span class="token token class-name-fully-qualified static-context" style="color:#39adb5">\</span><span class="token token class-name-fully-qualified static-context" style="color:#6182b8">OutOfMemoryBootstrapper</span><span class="token token" style="color:#39adb5">::</span><span class="token token" style="color:#7c4dff">class</span><span class="token token" style="color:#39adb5">]</span><span class="token token" style="color:#39adb5">,</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">5</span><span>        </span><span class="token token scope" style="color:#7c4dff">parent</span><span class="token token scope" style="color:#39adb5">::</span><span class="token token" style="color:#7c4dff">bootstrappers</span><span class="token token" style="color:#39adb5">(</span><span class="token token" style="color:#39adb5">)</span><span class="token token" style="color:#39adb5">,</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">6</span><span>    </span><span class="token token" style="color:#39adb5">)</span><span class="token token" style="color:#39adb5">;</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">7</span><span></span><span class="token token" style="color:#39adb5">}</span></span></code></pre></div></pre><p>The OutOfMemoryBootstrapper must be the first registered bootstrapper, or it may not be called before the out of memory exception crashes your app.</p><div class="font-semibold my-5 text-4xl"><h2 id="before-flush-callback" class="inline-block">Before flush callback</h2><span class="hidden md:inline-block m-1 text-sm 2xl:text-base cursor-pointer text-transparent hover:text-gray-400" title="Copy link to this heading" aria-hidden="true">¶</span></div><p>The package allows you to register a callback before data are sent to the remote platform. Paste the code below in the boot method of your AppServiceProvider:</p><pre><div class="clean"><div class="relative h-0"><button class="no-print absolute top-1 right-1 rounded w-7 h-7 p-1 z-10 text-gray-500 dark:bg-gray-900 dark:text-gray-400 focus:outline-none" title="Copy to clipboard"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path></svg></button></div><pre class="text-sm 2xl:text-base overflow-x-auto py-3 my-4 
                           rounded dark:bg-gray-900 dark:text-gray-200
    bg-gray-50 text-gray-900 mt-4"><code class="" style="white-space:pre"><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">1</span><span class="token token" style="color:#7c4dff">use</span><span> </span><span class="token token package">Ultimate</span><span class="token token package" style="color:#39adb5">\</span><span class="token token package">Laravel</span><span class="token token package" style="color:#39adb5">\</span><span class="token token package">Facades</span><span class="token token package" style="color:#39adb5">\</span><span class="token token package">Ultimate</span><span class="token token" style="color:#39adb5">;</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">2</span>
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">3</span><span></span><span class="token token scope">Ultimate</span><span class="token token scope" style="color:#39adb5">::</span><span class="token token" style="color:#7c4dff">beforeFlush</span><span class="token token" style="color:#39adb5">(</span><span class="token token" style="color:#7c4dff">function</span><span> </span><span class="token token" style="color:#39adb5">(</span><span class="token token" style="color:#e53935">$ultimate</span><span class="token token" style="color:#39adb5">)</span><span> </span><span class="token token" style="color:#39adb5">{</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">4</span><span>    </span><span class="token token" style="color:#aabfc9">// Do something before data are sent.</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">5</span><span></span><span class="token token" style="color:#39adb5">}</span><span class="token token" style="color:#39adb5">)</span><span class="token token" style="color:#39adb5">;</span></span></code></pre></div></pre><p>The callback will receive the current Palzin APM instance as parameter.</p><div class="font-semibold my-5 text-3xl"><h3 id="sampling-a-specific-transaction" class="inline-block">Sampling a specific transaction</h3><span class="hidden md:inline-block m-1 text-sm 2xl:text-base cursor-pointer text-transparent hover:text-gray-400" title="Copy link to this heading" aria-hidden="true">¶</span></div><p>The most common use case for beforeFlush method is sampling. If your application execute a specific transaction for a huge number of times every hour, it could be useful to sample this transasction to mitigate the quota consumption still guaranteeing a good level of detail of the metrics.</p><p>In the example below we report only the 70% of the ExampleJob executions:</p><pre><div class="clean"><div class="relative h-0"><button class="no-print absolute top-1 right-1 rounded w-7 h-7 p-1 z-10 text-gray-500 dark:bg-gray-900 dark:text-gray-400 focus:outline-none" title="Copy to clipboard"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path></svg></button></div><pre class="text-sm 2xl:text-base overflow-x-auto py-3 my-4 
                           rounded dark:bg-gray-900 dark:text-gray-200
    bg-gray-50 text-gray-900 mt-4"><code class="" style="white-space:pre"><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">1</span><span class="token token php language-php delimiter" style="color:#7c4dff;font-weight:bold">&lt;?php</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px" class="token token php language-php"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">2</span>
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">3</span><span class="token token php language-php"></span><span class="token token php language-php" style="color:#7c4dff">namespace</span><span class="token token php language-php"> </span><span class="token token php language-php package">App</span><span class="token token php language-php package" style="color:#39adb5">\</span><span class="token token php language-php package">Providers</span><span class="token token php language-php" style="color:#39adb5">;</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px" class="token token php language-php"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">4</span>
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">5</span><span class="token token php language-php"></span><span class="token token php language-php" style="color:#7c4dff">use</span><span class="token token php language-php"> </span><span class="token token php language-php package">App</span><span class="token token php language-php package" style="color:#39adb5">\</span><span class="token token php language-php package">Jobs</span><span class="token token php language-php package" style="color:#39adb5">\</span><span class="token token php language-php package">ExampleJob</span><span class="token token php language-php" style="color:#39adb5">;</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">6</span><span class="token token php language-php"></span><span class="token token php language-php" style="color:#7c4dff">use</span><span class="token token php language-php"> </span><span class="token token php language-php package">Illuminate</span><span class="token token php language-php package" style="color:#39adb5">\</span><span class="token token php language-php package">Support</span><span class="token token php language-php package" style="color:#39adb5">\</span><span class="token token php language-php package">ServiceProvider</span><span class="token token php language-php" style="color:#39adb5">;</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">7</span><span class="token token php language-php"></span><span class="token token php language-php" style="color:#7c4dff">use</span><span class="token token php language-php"> </span><span class="token token php language-php package">Ultimate</span><span class="token token php language-php package" style="color:#39adb5">\</span><span class="token token php language-php package">Laravel</span><span class="token token php language-php package" style="color:#39adb5">\</span><span class="token token php language-php package">Facades</span><span class="token token php language-php package" style="color:#39adb5">\</span><span class="token token php language-php package">Ultimate</span><span class="token token php language-php" style="color:#39adb5">;</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px" class="token token php language-php"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">8</span>
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">9</span><span class="token token php language-php"></span><span class="token token php language-php" style="color:#7c4dff">class</span><span class="token token php language-php"> </span><span class="token token php language-php class-name-definition" style="color:#6182b8">AppServiceProvider</span><span class="token token php language-php"> </span><span class="token token php language-php" style="color:#7c4dff">extends</span><span class="token token php language-php"> </span><span class="token token php language-php" style="color:#6182b8">ServiceProvider</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">10</span><span class="token token php language-php"></span><span class="token token php language-php" style="color:#39adb5">{</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">11</span><span class="token token php language-php">    </span><span class="token token php language-php doc-comment" style="color:#aabfc9">/**
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px;color:#aabfc9" class="token token php language-php doc-comment"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">12</span>     * Register any application services.
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px;color:#aabfc9" class="token token php language-php doc-comment"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">13</span>     *
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">14</span><span class="token token php language-php doc-comment" style="color:#aabfc9">     * </span><span class="token token php language-php doc-comment" style="color:#aabfc9">@return</span><span class="token token php language-php doc-comment" style="color:#aabfc9"> </span><span class="token token php language-php doc-comment" style="color:#aabfc9">void</span><span class="token token php language-php doc-comment" style="color:#aabfc9">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">15</span><span class="token token php language-php doc-comment" style="color:#aabfc9">     */</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">16</span><span class="token token php language-php">    </span><span class="token token php language-php" style="color:#7c4dff">public</span><span class="token token php language-php"> </span><span class="token token php language-php" style="color:#7c4dff">function</span><span class="token token php language-php"> </span><span class="token token php language-php function-definition" style="color:#7c4dff">register</span><span class="token token php language-php" style="color:#39adb5">(</span><span class="token token php language-php" style="color:#39adb5">)</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">17</span><span class="token token php language-php">    </span><span class="token token php language-php" style="color:#39adb5">{</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">18</span><span class="token token php language-php">        </span><span class="token token php language-php" style="color:#aabfc9">//</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">19</span><span class="token token php language-php">    </span><span class="token token php language-php" style="color:#39adb5">}</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px" class="token token php language-php"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">20</span>
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">21</span><span class="token token php language-php">    </span><span class="token token php language-php doc-comment" style="color:#aabfc9">/**
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px;color:#aabfc9" class="token token php language-php doc-comment"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">22</span>     * Bootstrap any application services.
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px;color:#aabfc9" class="token token php language-php doc-comment"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">23</span>     *
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">24</span><span class="token token php language-php doc-comment" style="color:#aabfc9">     * </span><span class="token token php language-php doc-comment" style="color:#aabfc9">@return</span><span class="token token php language-php doc-comment" style="color:#aabfc9"> </span><span class="token token php language-php doc-comment" style="color:#aabfc9">void</span><span class="token token php language-php doc-comment" style="color:#aabfc9">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">25</span><span class="token token php language-php doc-comment" style="color:#aabfc9">     */</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">26</span><span class="token token php language-php">    </span><span class="token token php language-php" style="color:#7c4dff">public</span><span class="token token php language-php"> </span><span class="token token php language-php" style="color:#7c4dff">function</span><span class="token token php language-php"> </span><span class="token token php language-php function-definition" style="color:#7c4dff">boot</span><span class="token token php language-php" style="color:#39adb5">(</span><span class="token token php language-php" style="color:#39adb5">)</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">27</span><span class="token token php language-php">    </span><span class="token token php language-php" style="color:#39adb5">{</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">28</span><span class="token token php language-php">        </span><span class="token token php language-php scope">Ultimate</span><span class="token token php language-php scope" style="color:#39adb5">::</span><span class="token token php language-php" style="color:#7c4dff">beforeFlush</span><span class="token token php language-php" style="color:#39adb5">(</span><span class="token token php language-php" style="color:#7c4dff">function</span><span class="token token php language-php"> </span><span class="token token php language-php" style="color:#39adb5">(</span><span class="token token php language-php" style="color:#e53935">$ultimate</span><span class="token token php language-php" style="color:#39adb5">)</span><span class="token token php language-php"> </span><span class="token token php language-php" style="color:#39adb5">{</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">29</span><span class="token token php language-php">            </span><span class="token token php language-php" style="color:#7c4dff">if</span><span class="token token php language-php"> </span><span class="token token php language-php" style="color:#39adb5">(</span><span class="token token php language-php" style="color:#e53935">$ultimate</span><span class="token token php language-php" style="color:#39adb5">-&gt;</span><span class="token token php language-php" style="color:#7c4dff">currentTransaction</span><span class="token token php language-php" style="color:#39adb5">(</span><span class="token token php language-php" style="color:#39adb5">)</span><span class="token token php language-php" style="color:#39adb5">-&gt;</span><span class="token token php language-php" style="color:#39adb5">name</span><span class="token token php language-php"> </span><span class="token token php language-php" style="color:#39adb5">===</span><span class="token token php language-php"> </span><span class="token token php language-php scope">ExampleJob</span><span class="token token php language-php scope" style="color:#39adb5">::</span><span class="token token php language-php" style="color:#7c4dff">class</span><span class="token token php language-php" style="color:#39adb5">)</span><span class="token token php language-php"> </span><span class="token token php language-php" style="color:#39adb5">{</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">30</span><span class="token token php language-php">                </span><span class="token token php language-php" style="color:#e53935">$prob</span><span class="token token php language-php"> </span><span class="token token php language-php" style="color:#39adb5">=</span><span class="token token php language-php"> </span><span class="token token php language-php" style="color:#7c4dff">mt_rand</span><span class="token token php language-php" style="color:#39adb5">(</span><span class="token token php language-php" style="color:#f76d47">0</span><span class="token token php language-php" style="color:#39adb5">,</span><span class="token token php language-php"> </span><span class="token token php language-php" style="color:#7c4dff">mt_getrandmax</span><span class="token token php language-php" style="color:#39adb5">(</span><span class="token token php language-php" style="color:#39adb5">)</span><span class="token token php language-php"> </span><span class="token token php language-php" style="color:#39adb5">-</span><span class="token token php language-php"> </span><span class="token token php language-php" style="color:#f76d47">1</span><span class="token token php language-php" style="color:#39adb5">)</span><span class="token token php language-php"> </span><span class="token token php language-php" style="color:#39adb5">/</span><span class="token token php language-php"> </span><span class="token token php language-php" style="color:#7c4dff">mt_getrandmax</span><span class="token token php language-php" style="color:#39adb5">(</span><span class="token token php language-php" style="color:#39adb5">)</span><span class="token token php language-php" style="color:#39adb5">;</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px" class="token token php language-php"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">31</span>                
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">32</span><span class="token token php language-php">                </span><span class="token token php language-php" style="color:#7c4dff">return</span><span class="token token php language-php"> </span><span class="token token php language-php" style="color:#e53935">$prob</span><span class="token token php language-php"> </span><span class="token token php language-php" style="color:#39adb5">&lt;</span><span class="token token php language-php"> </span><span class="token token php language-php" style="color:#f76d47">0.7</span><span class="token token php language-php" style="color:#39adb5">;</span><span class="token token php language-php"> </span><span class="token token php language-php" style="color:#aabfc9">// Report 70% of the executions</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">33</span><span class="token token php language-php">            </span><span class="token token php language-php" style="color:#39adb5">}</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">34</span><span class="token token php language-php">        </span><span class="token token php language-php" style="color:#39adb5">}</span><span class="token token php language-php" style="color:#39adb5">)</span><span class="token token php language-php" style="color:#39adb5">;</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">35</span><span class="token token php language-php">    </span><span class="token token php language-php" style="color:#39adb5">}</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">36</span><span class="token token php language-php"></span><span class="token token php language-php" style="color:#39adb5">}</span></span></code></pre></div></pre><div class="font-semibold my-5 text-3xl"><h3 id="set-a-custom-service-name" class="inline-block">Set a custom service name</h3><span class="hidden md:inline-block m-1 text-sm 2xl:text-base cursor-pointer text-transparent hover:text-gray-400" title="Copy link to this heading" aria-hidden="true">¶</span></div><p>If your application runs in Kubernates cluster or use &quot;auto-scaling&quot; you could see a bit of mess in your charts. It is probably due to the constant turnover of servers to handle the application load dynamically.</p><p>It may be useful to monitor each autoscaling group with the same name regardless of the hostnames of the servers that are continuously turned on and off.</p><p>Using the beforeFlush() method you can group your monitoring data by services (API, workers, web app, etc) instead by hostnames:</p><pre><div class="clean"><div class="relative h-0"><button class="no-print absolute top-1 right-1 rounded w-7 h-7 p-1 z-10 text-gray-500 dark:bg-gray-900 dark:text-gray-400 focus:outline-none" title="Copy to clipboard"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path></svg></button></div><pre class="text-sm 2xl:text-base overflow-x-auto py-3 my-4 
                           rounded dark:bg-gray-900 dark:text-gray-200
    bg-gray-50 text-gray-900 mt-4"><code class="" style="white-space:pre"><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">1</span><span class="token token php language-php delimiter" style="color:#7c4dff;font-weight:bold">&lt;?php</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px" class="token token php language-php"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">2</span>
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">3</span><span class="token token php language-php"></span><span class="token token php language-php" style="color:#7c4dff">namespace</span><span class="token token php language-php"> </span><span class="token token php language-php package">App</span><span class="token token php language-php package" style="color:#39adb5">\</span><span class="token token php language-php package">Providers</span><span class="token token php language-php" style="color:#39adb5">;</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px" class="token token php language-php"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">4</span>
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">5</span><span class="token token php language-php"></span><span class="token token php language-php" style="color:#7c4dff">use</span><span class="token token php language-php"> </span><span class="token token php language-php package">App</span><span class="token token php language-php package" style="color:#39adb5">\</span><span class="token token php language-php package">Jobs</span><span class="token token php language-php package" style="color:#39adb5">\</span><span class="token token php language-php package">ExampleJob</span><span class="token token php language-php" style="color:#39adb5">;</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">6</span><span class="token token php language-php"></span><span class="token token php language-php" style="color:#7c4dff">use</span><span class="token token php language-php"> </span><span class="token token php language-php package">Illuminate</span><span class="token token php language-php package" style="color:#39adb5">\</span><span class="token token php language-php package">Support</span><span class="token token php language-php package" style="color:#39adb5">\</span><span class="token token php language-php package">ServiceProvider</span><span class="token token php language-php" style="color:#39adb5">;</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">7</span><span class="token token php language-php"></span><span class="token token php language-php" style="color:#7c4dff">use</span><span class="token token php language-php"> </span><span class="token token php language-php package">Ultimate</span><span class="token token php language-php package" style="color:#39adb5">\</span><span class="token token php language-php package">Laravel</span><span class="token token php language-php package" style="color:#39adb5">\</span><span class="token token php language-php package">Facades</span><span class="token token php language-php package" style="color:#39adb5">\</span><span class="token token php language-php package">Ultimate</span><span class="token token php language-php" style="color:#39adb5">;</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px" class="token token php language-php"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">8</span>
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">9</span><span class="token token php language-php"></span><span class="token token php language-php" style="color:#7c4dff">class</span><span class="token token php language-php"> </span><span class="token token php language-php class-name-definition" style="color:#6182b8">AppServiceProvider</span><span class="token token php language-php"> </span><span class="token token php language-php" style="color:#7c4dff">extends</span><span class="token token php language-php"> </span><span class="token token php language-php" style="color:#6182b8">ServiceProvider</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">10</span><span class="token token php language-php"></span><span class="token token php language-php" style="color:#39adb5">{</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">11</span><span class="token token php language-php">    </span><span class="token token php language-php doc-comment" style="color:#aabfc9">/**
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px;color:#aabfc9" class="token token php language-php doc-comment"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">12</span>     * Register any application services.
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px;color:#aabfc9" class="token token php language-php doc-comment"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">13</span>     *
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">14</span><span class="token token php language-php doc-comment" style="color:#aabfc9">     * </span><span class="token token php language-php doc-comment" style="color:#aabfc9">@return</span><span class="token token php language-php doc-comment" style="color:#aabfc9"> </span><span class="token token php language-php doc-comment" style="color:#aabfc9">void</span><span class="token token php language-php doc-comment" style="color:#aabfc9">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">15</span><span class="token token php language-php doc-comment" style="color:#aabfc9">     */</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">16</span><span class="token token php language-php">    </span><span class="token token php language-php" style="color:#7c4dff">public</span><span class="token token php language-php"> </span><span class="token token php language-php" style="color:#7c4dff">function</span><span class="token token php language-php"> </span><span class="token token php language-php function-definition" style="color:#7c4dff">register</span><span class="token token php language-php" style="color:#39adb5">(</span><span class="token token php language-php" style="color:#39adb5">)</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">17</span><span class="token token php language-php">    </span><span class="token token php language-php" style="color:#39adb5">{</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">18</span><span class="token token php language-php">        </span><span class="token token php language-php" style="color:#aabfc9">//</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">19</span><span class="token token php language-php">    </span><span class="token token php language-php" style="color:#39adb5">}</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px" class="token token php language-php"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">20</span>
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">21</span><span class="token token php language-php">    </span><span class="token token php language-php doc-comment" style="color:#aabfc9">/**
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px;color:#aabfc9" class="token token php language-php doc-comment"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">22</span>     * Bootstrap any application services.
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px;color:#aabfc9" class="token token php language-php doc-comment"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">23</span>     *
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">24</span><span class="token token php language-php doc-comment" style="color:#aabfc9">     * </span><span class="token token php language-php doc-comment" style="color:#aabfc9">@return</span><span class="token token php language-php doc-comment" style="color:#aabfc9"> </span><span class="token token php language-php doc-comment" style="color:#aabfc9">void</span><span class="token token php language-php doc-comment" style="color:#aabfc9">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">25</span><span class="token token php language-php doc-comment" style="color:#aabfc9">     */</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">26</span><span class="token token php language-php">    </span><span class="token token php language-php" style="color:#7c4dff">public</span><span class="token token php language-php"> </span><span class="token token php language-php" style="color:#7c4dff">function</span><span class="token token php language-php"> </span><span class="token token php language-php function-definition" style="color:#7c4dff">boot</span><span class="token token php language-php" style="color:#39adb5">(</span><span class="token token php language-php" style="color:#39adb5">)</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">27</span><span class="token token php language-php">    </span><span class="token token php language-php" style="color:#39adb5">{</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">28</span><span class="token token php language-php">        </span><span class="token token php language-php scope">Ultimate</span><span class="token token php language-php scope" style="color:#39adb5">::</span><span class="token token php language-php" style="color:#7c4dff">beforeFlush</span><span class="token token php language-php" style="color:#39adb5">(</span><span class="token token php language-php" style="color:#7c4dff">function</span><span class="token token php language-php"> </span><span class="token token php language-php" style="color:#39adb5">(</span><span class="token token php language-php" style="color:#e53935">$ultimate</span><span class="token token php language-php" style="color:#39adb5">)</span><span class="token token php language-php"> </span><span class="token token php language-php" style="color:#39adb5">{</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">29</span><span class="token token php language-php">            </span><span class="token token php language-php" style="color:#e53935">$ultimate</span><span class="token token php language-php" style="color:#39adb5">-&gt;</span><span class="token token php language-php" style="color:#7c4dff">currentTransaction</span><span class="token token php language-php" style="color:#39adb5">(</span><span class="token token php language-php" style="color:#39adb5">)</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">30</span><span class="token token php language-php">                </span><span class="token token php language-php" style="color:#39adb5">-&gt;</span><span class="token token php language-php" style="color:#39adb5">host</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">31</span><span class="token token php language-php">                </span><span class="token token php language-php" style="color:#39adb5">-&gt;</span><span class="token token php language-php" style="color:#39adb5">hostname</span><span class="token token php language-php"> </span><span class="token token php language-php" style="color:#39adb5">=</span><span class="token token php language-php"> </span><span class="token token php language-php" style="color:#7c4dff">config</span><span class="token token php language-php" style="color:#39adb5">(</span><span class="token token php language-php single-quoted-string" style="color:#f6a434">&#x27;app.service_name&#x27;</span><span class="token token php language-php" style="color:#39adb5">)</span><span class="token token php language-php" style="color:#39adb5">??</span><span class="token token php language-php single-quoted-string" style="color:#f6a434">&#x27;rest-api&#x27;</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">32</span><span class="token token php language-php">        </span><span class="token token php language-php" style="color:#39adb5">}</span><span class="token token php language-php" style="color:#39adb5">)</span><span class="token token php language-php" style="color:#39adb5">;</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">33</span><span class="token token php language-php">    </span><span class="token token php language-php" style="color:#39adb5">}</span><span class="token token php language-php">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">34</span><span class="token token php language-php"></span><span class="token token php language-php" style="color:#39adb5">}</span></span></code></pre></div></pre><p>In the example above you can get your service name by a custom configuration property, or alternatively you could create an environment variable. You are free to configure it based also on your CI/CD pipelines.</p><div class="font-semibold my-5 text-4xl"><h2 id="access-the-palzin-apm-instance" class="inline-block">Access the Palzin APM instance</h2><span class="hidden md:inline-block m-1 text-sm 2xl:text-base cursor-pointer text-transparent hover:text-gray-400" title="Copy link to this heading" aria-hidden="true">¶</span></div><p>You can get the current Palzin APM instance using the helper function or the Facade:</p><pre><div class="clean"><div class="relative h-0"><button class="no-print absolute top-1 right-1 rounded w-7 h-7 p-1 z-10 text-gray-500 dark:bg-gray-900 dark:text-gray-400 focus:outline-none" title="Copy to clipboard"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path></svg></button></div><pre class="text-sm 2xl:text-base overflow-x-auto py-3 my-4 
                           rounded dark:bg-gray-900 dark:text-gray-200
    bg-gray-50 text-gray-900 mt-4"><code class="" style="white-space:pre"><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">1</span><span class="token token" style="color:#aabfc9">/*
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px;color:#aabfc9" class="token token"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">2</span> * Using the helper function
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">3</span><span class="token token" style="color:#aabfc9"> */</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">4</span><span></span><span class="token token" style="color:#7c4dff">ultimate</span><span class="token token" style="color:#39adb5">(</span><span class="token token" style="color:#39adb5">)</span><span class="token token" style="color:#39adb5">-&gt;</span><span class="token token" style="color:#7c4dff">addSegment</span><span class="token token" style="color:#39adb5">(</span><span class="token token" style="color:#7c4dff">function</span><span> </span><span class="token token" style="color:#39adb5">(</span><span class="token token" style="color:#39adb5">)</span><span> </span><span class="token token" style="color:#39adb5">{</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">5</span><span>    </span><span class="token token" style="color:#aabfc9">// Do something</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">6</span><span></span><span class="token token" style="color:#39adb5">}</span><span class="token token" style="color:#39adb5">,</span><span> </span><span class="token token single-quoted-string" style="color:#f6a434">&#x27;label&#x27;</span><span class="token token" style="color:#39adb5">)</span><span class="token token" style="color:#39adb5">;</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">7</span>
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">8</span>
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">9</span>
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">10</span><span></span><span class="token token" style="color:#aabfc9">/*
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px;color:#aabfc9" class="token token"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">11</span> * Using the Facade
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">12</span><span class="token token" style="color:#aabfc9"> */</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">13</span><span></span><span class="token token class-name-fully-qualified static-context" style="color:#39adb5">\</span><span class="token token class-name-fully-qualified static-context" style="color:#6182b8">Ultimate</span><span class="token token class-name-fully-qualified static-context" style="color:#39adb5">\</span><span class="token token class-name-fully-qualified static-context" style="color:#6182b8">Laravel</span><span class="token token class-name-fully-qualified static-context" style="color:#39adb5">\</span><span class="token token class-name-fully-qualified static-context" style="color:#6182b8">Facades</span><span class="token token class-name-fully-qualified static-context" style="color:#39adb5">\</span><span class="token token class-name-fully-qualified static-context" style="color:#6182b8">Ultimate</span><span class="token token" style="color:#39adb5">::</span><span class="token token" style="color:#7c4dff">addSegment</span><span class="token token" style="color:#39adb5">(</span><span class="token token" style="color:#7c4dff">function</span><span> </span><span class="token token" style="color:#39adb5">(</span><span class="token token" style="color:#39adb5">)</span><span> </span><span class="token token" style="color:#39adb5">{</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">14</span><span>    </span><span class="token token" style="color:#aabfc9">// Do something</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">15</span><span></span><span class="token token" style="color:#39adb5">}</span><span class="token token" style="color:#39adb5">,</span><span> </span><span class="token token single-quoted-string" style="color:#f6a434">&#x27;label&#x27;</span><span class="token token" style="color:#39adb5">)</span><span class="token token" style="color:#39adb5">;</span></span></code></pre></div></pre><p>The current Palzin APM instance is binded in the Laravel service container. In your controller, you can type-hint an argument with the Ultimate&#x27;s class name.</p><pre><div class="clean"><div class="relative h-0"><button class="no-print absolute top-1 right-1 rounded w-7 h-7 p-1 z-10 text-gray-500 dark:bg-gray-900 dark:text-gray-400 focus:outline-none" title="Copy to clipboard"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path></svg></button></div><pre class="text-sm 2xl:text-base overflow-x-auto py-3 my-4 
                           rounded dark:bg-gray-900 dark:text-gray-200
    bg-gray-50 text-gray-900 mt-4"><code class="" style="white-space:pre"><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">1</span><span class="token token" style="color:#7c4dff">namespace</span><span> </span><span class="token token package">App</span><span class="token token package" style="color:#39adb5">\</span><span class="token token package">Http</span><span class="token token package" style="color:#39adb5">\</span><span class="token token package">Controllers</span><span class="token token" style="color:#39adb5">;</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">2</span>
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">3</span><span></span><span class="token token" style="color:#7c4dff">use</span><span> </span><span class="token token package">Illuminate</span><span class="token token package" style="color:#39adb5">\</span><span class="token token package">Http</span><span class="token token package" style="color:#39adb5">\</span><span class="token token package">Request</span><span class="token token" style="color:#39adb5">;</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">4</span><span></span><span class="token token" style="color:#7c4dff">use</span><span> </span><span class="token token package">Ultimate</span><span class="token token package" style="color:#39adb5">\</span><span class="token token package">Laravel</span><span class="token token package" style="color:#39adb5">\</span><span class="token token package">Ultimate</span><span class="token token" style="color:#39adb5">;</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">5</span>
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">6</span><span></span><span class="token token" style="color:#7c4dff">class</span><span> </span><span class="token token class-name-definition" style="color:#6182b8">HomeController</span><span> </span><span class="token token" style="color:#7c4dff">extends</span><span> </span><span class="token token" style="color:#6182b8">Controller</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">7</span><span></span><span class="token token" style="color:#39adb5">{</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">8</span><span>    </span><span class="token token doc-comment" style="color:#aabfc9">/**
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px;color:#aabfc9" class="token token doc-comment"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">9</span>     * Show the application dashboard.
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px;color:#aabfc9" class="token token doc-comment"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">10</span>     *
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">11</span><span class="token token doc-comment" style="color:#aabfc9">     * </span><span class="token token doc-comment" style="color:#7c4dff">@return</span><span class="token token doc-comment" style="color:#aabfc9"> </span><span class="token token doc-comment" style="color:#39adb5">\</span><span class="token token doc-comment" style="color:#6182b8">Illuminate</span><span class="token token doc-comment" style="color:#39adb5">\</span><span class="token token doc-comment" style="color:#6182b8">Contracts</span><span class="token token doc-comment" style="color:#39adb5">\</span><span class="token token doc-comment" style="color:#6182b8">Support</span><span class="token token doc-comment" style="color:#39adb5">\</span><span class="token token doc-comment" style="color:#6182b8">Renderable</span><span class="token token doc-comment" style="color:#aabfc9">
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">12</span><span class="token token doc-comment" style="color:#aabfc9">     */</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">13</span><span>    </span><span class="token token" style="color:#7c4dff">public</span><span> </span><span class="token token" style="color:#7c4dff">function</span><span> </span><span class="token token function-definition" style="color:#7c4dff">index</span><span class="token token" style="color:#39adb5">(</span><span class="token token type-declaration" style="color:#6182b8">Ultimate</span><span> </span><span class="token token" style="color:#e53935">$ultimate</span><span class="token token" style="color:#39adb5">)</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">14</span><span>    </span><span class="token token" style="color:#39adb5">{</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">15</span><span>        </span><span class="token token" style="color:#7c4dff">return</span><span> </span><span class="token token" style="color:#7c4dff">view</span><span class="token token" style="color:#39adb5">(</span><span class="token token single-quoted-string" style="color:#f6a434">&#x27;home&#x27;</span><span class="token token" style="color:#39adb5">)</span><span class="token token" style="color:#39adb5">;</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">16</span><span>    </span><span class="token token" style="color:#39adb5">}</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">17</span><span></span><span class="token token" style="color:#39adb5">}</span></span></code></pre></div></pre></div><hr class="my-3 mx-1 print:hidden border-gray-300 dark:border-gray-600"/><div class="my-2 no-print"><div class="flex flex-col-reverse sm:flex-row false"><a class="border footer-link-option border-transparent w-full justify-center md:justify-between rounded m-1 p-3 bg-gray-300 text-gray-700 hover:border-gray-400 hover:text-gray-900 dark:bg-gray-700 dark:text-gray-200 dark:hover:border-gray-600 dark:hover:text-gray-100 false" title="Previous chapter (&lt;-)" href="/laravel/upgrade-guide"><span class="previous-tag">Previous</span><div class="flex w-full justify-center md:justify-between"><svg preserveAspectRatio="xMidYMid meet" height="1.6em" width="1.6em" fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor"><g><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></g></svg><div class="ml-2">Upgrade Guide</div></div></a><a class="border footer-link-option border-transparent w-full justify-center md:justify-between rounded m-1 p-3 bg-gray-300 text-gray-700 hover:border-gray-400 hover:text-gray-900 dark:bg-gray-700 dark:text-gray-200 dark:hover:border-gray-600 dark:hover:text-gray-100 false" title="Next chapter (-&gt;)" href="/laravel/usage"><span class="next-tag">Next</span><div class="flex w-full justify-center md:justify-between"><div class="mr-2">Http Requests Monitoring</div><svg preserveAspectRatio="xMidYMid meet" height="1.6em" width="1.6em" fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor"><g><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></g></svg></div></a></div></div></div><div class="toc-container flex-none w-56 hidden lg:block"><div class="toc sticky top-20"><div class="pr-2"><div class="content-toc-title font-medium rounded py-2"><svg height="18" viewBox="0 0 48 48" width="18" xmlns="http://www.w3.org/2000/svg"><path d="M6 42h36v-4h-36v4zm12-8h24v-4h-24v4zm-12-8h36v-4h-36v4zm12-8h24v-4h-24v4zm-12-12v4h36v-4h-36z"></path><path d="M0 0h48v48h-48z" fill="none"></path></svg><span>Contents</span></div><ul class="tracking-wide mt-4 text-gray-600 dark:text-gray-400 text-sm 2xl:text-base border-0 border-l border-gray-300 dark:border-gray-600 leading-6 cursor-pointer"></ul></div></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"source":{"compiledSource":"var u=Object.defineProperty,m=Object.defineProperties;var h=Object.getOwnPropertyDescriptors;var n=Object.getOwnPropertySymbols;var i=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable;var s=(a,t,r)=\u003et in a?u(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,e=(a,t)=\u003e{for(var r in t||(t={}))i.call(t,r)\u0026\u0026s(a,r,t[r]);if(n)for(var r of n(t))p.call(t,r)\u0026\u0026s(a,r,t[r]);return a},l=(a,t)=\u003em(a,h(t));var c=(a,t)=\u003e{var r={};for(var o in a)i.call(a,o)\u0026\u0026t.indexOf(o)\u003c0\u0026\u0026(r[o]=a[o]);if(a!=null\u0026\u0026n)for(var o of n(a))t.indexOf(o)\u003c0\u0026\u0026p.call(a,o)\u0026\u0026(r[o]=a[o]);return r};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(r){var o=r,{components:a}=o,t=c(o,[\"components\"]);return mdx(MDXLayout,l(e(e({},layoutProps),t),{components:a,mdxType:\"MDXLayout\"}),mdx(\"hr\",null),mdx(\"h3\",e({},{id:\"server-requirements\"}),\"Server requirements\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"PHP \u003e= 7.2\"),mdx(\"li\",{parentName:\"ul\"},\"Laravel \u003e= 5.5\")),mdx(\"p\",null,\"To verify what version of PHP is installed on your server run this command in your terminal: \",mdx(\"strong\",{parentName:\"p\"},\"php -v\")),mdx(\"p\",null,\"To know what is the Laravel version behind your application run this command in your application's main directory: \",mdx(\"strong\",{parentName:\"p\"},\"php artisan --version\")),mdx(\"h3\",e({},{id:\"clear-the-laravel-configuration\"}),\"Clear the Laravel configuration\"),mdx(\"p\",null,\"Before installing the package you should clear your Laravel configuration to avoid unexpected error loading the default package config file.\"),mdx(\"p\",null,\"Run the command below to clear your cached configuration:\"),mdx(\"p\",null,mdx(\"strong\",{parentName:\"p\"},\"php artisan config:clear\")),mdx(\"h3\",e({},{id:\"install\"}),\"Install\"),mdx(\"p\",null,\"Type the command below in your terminal to install the latest version of the package:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-php\"}),`composer require ingress-it-solutions/ultimate-laravel\n`)),mdx(\"h3\",e({},{id:\"for-lumen\"}),\"For Lumen\"),mdx(\"p\",null,\"If your application is based on Lumen you need to manually register the UltimateServiceProvider:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-php\"}),`$app-\u003eregister(\\\\Ultimate\\\\Laravel\\\\UltimateServiceProvider::class);\n`)),mdx(\"p\",null,\"If you wish to use the \\\\Ultimate\\\\Laravel\\\\Facades\\\\Ultimate facade, you should also enable facades if you did not already by uncommenting the withFacades() call in bootstrap/app.php:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-php\"}),`$app-\u003ewithFacades();\n`)),mdx(\"h3\",e({},{id:\"configure-the-ingestion-key\"}),\"Configure the Ingestion Key\"),mdx(\"p\",null,\"Get a new Ingestion Key by signing up for Palzin APM (\",mdx(\"a\",e({parentName:\"p\"},{href:\"https://app.ultimate.dev/register\",target:\"_blank\",rel:\"nofollow noopener noreferrer\"}),\"https://app.ultimate.dev/register\"),\") and creating a new application.\"),mdx(\"p\",null,\"Put the Palzin APM Ingestion Key in your environment file:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-php\"}),`ULTIMATE_INGESTION_KEY=[ingestion key]\n`)),mdx(\"h3\",e({},{id:\"test-everything-is-working\"}),\"Test everything is working\"),mdx(\"p\",null,\"Execute the test command to check if your app can send data to Palzin APM correctly:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-php\"}),`php artisan ultimate:test\n`)),mdx(\"p\",null,\"Go to \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://www.palzin.app/\",target:\"_blank\",rel:\"nofollow noopener noreferrer\"}),\"https://www.palzin.app/\"),\" to explore your data.\"),mdx(\"p\",null,\"By default Palzin APM will monitor everything executed in background:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"Queued Jobs\"),mdx(\"li\",{parentName:\"ul\"},\"Artisan commands\"),mdx(\"li\",{parentName:\"ul\"},\"Unhandled Exceptions\")),mdx(\"p\",e({},{className:\"hint tip\"}),\"If you want learn more about background jobs monitoring take a look on our article: \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://www.palzin.app/laravel-background-jobs-commands-monitoring-with-ultimate/\",target:\"_blank\",rel:\"nofollow noopener noreferrer\"}),\"https://www.palzin.app/laravel-background-jobs-commands-monitoring-with-ultimate/\")),mdx(\"p\",null,\"Go the \",mdx(\"a\",e({parentName:\"p\"},{href:\"\"}),\"Http Request Monitoring\"),\" section to understand how to trace your application when it's executed due to an incoming http request.\"),mdx(\"h3\",e({},{id:\"reporting-out-of-memory-errors\"}),\"Reporting Out Of Memory Errors\"),mdx(\"p\",null,\"When your app runs out of memory it's needed to temporary increase the PHP memory limit to ensure Palzin APM can report the current transaction. To do this, a \\u201Cbootstrapper\\u201D class must be registered in both the app/Http/Kernel.php and app/Console/Kernel.php files:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-php\"}),`protected function bootstrappers()\n{\n    return array_merge(\n        [\\\\Ultimate\\\\Laravel\\\\OutOfMemoryBootstrapper::class],\n        parent::bootstrappers(),\n    );\n}\n`)),mdx(\"p\",null,\"The OutOfMemoryBootstrapper must be the first registered bootstrapper, or it may not be called before the out of memory exception crashes your app.\"),mdx(\"h2\",e({},{id:\"before-flush-callback\"}),\"Before flush callback\"),mdx(\"p\",null,\"The package allows you to register a callback before data are sent to the remote platform. Paste the code below in the boot method of your AppServiceProvider:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-php\"}),`use Ultimate\\\\Laravel\\\\Facades\\\\Ultimate;\n\nUltimate::beforeFlush(function ($ultimate) {\n    // Do something before data are sent.\n});\n\n`)),mdx(\"p\",null,\"The callback will receive the current Palzin APM instance as parameter.\"),mdx(\"h3\",e({},{id:\"sampling-a-specific-transaction\"}),\"Sampling a specific transaction\"),mdx(\"p\",null,\"The most common use case for beforeFlush method is sampling. If your application execute a specific transaction for a huge number of times every hour, it could be useful to sample this transasction to mitigate the quota consumption still guaranteeing a good level of detail of the metrics.\"),mdx(\"p\",null,\"In the example below we report only the 70% of the ExampleJob executions:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-php\"}),`\u003c?php\n\nnamespace App\\\\Providers;\n\nuse App\\\\Jobs\\\\ExampleJob;\nuse Illuminate\\\\Support\\\\ServiceProvider;\nuse Ultimate\\\\Laravel\\\\Facades\\\\Ultimate;\n\nclass AppServiceProvider extends ServiceProvider\n{\n    /**\n     * Register any application services.\n     *\n     * @return void\n     */\n    public function register()\n    {\n        //\n    }\n\n    /**\n     * Bootstrap any application services.\n     *\n     * @return void\n     */\n    public function boot()\n    {\n        Ultimate::beforeFlush(function ($ultimate) {\n            if ($ultimate-\u003ecurrentTransaction()-\u003ename === ExampleJob::class) {\n                $prob = mt_rand(0, mt_getrandmax() - 1) / mt_getrandmax();\n                \n                return $prob \u003c 0.7; // Report 70% of the executions\n            }\n        });\n    }\n}\n\n`)),mdx(\"h3\",e({},{id:\"set-a-custom-service-name\"}),\"Set a custom service name\"),mdx(\"p\",null,'If your application runs in Kubernates cluster or use \"auto-scaling\" you could see a bit of mess in your charts. It is probably due to the constant turnover of servers to handle the application load dynamically.'),mdx(\"p\",null,\"It may be useful to monitor each autoscaling group with the same name regardless of the hostnames of the servers that are continuously turned on and off.\"),mdx(\"p\",null,\"Using the beforeFlush() method you can group your monitoring data by services (API, workers, web app, etc) instead by hostnames:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-php\"}),`\u003c?php\n\nnamespace App\\\\Providers;\n\nuse App\\\\Jobs\\\\ExampleJob;\nuse Illuminate\\\\Support\\\\ServiceProvider;\nuse Ultimate\\\\Laravel\\\\Facades\\\\Ultimate;\n\nclass AppServiceProvider extends ServiceProvider\n{\n    /**\n     * Register any application services.\n     *\n     * @return void\n     */\n    public function register()\n    {\n        //\n    }\n\n    /**\n     * Bootstrap any application services.\n     *\n     * @return void\n     */\n    public function boot()\n    {\n        Ultimate::beforeFlush(function ($ultimate) {\n            $ultimate-\u003ecurrentTransaction()\n                -\u003ehost\n                -\u003ehostname = config('app.service_name')??'rest-api'\n        });\n    }\n}\n`)),mdx(\"p\",null,\"In the example above you can get your service name by a custom configuration property, or alternatively you could create an environment variable. You are free to configure it based also on your CI/CD pipelines.\"),mdx(\"h2\",e({},{id:\"access-the-palzin-apm-instance\"}),\"Access the Palzin APM instance\"),mdx(\"p\",null,\"You can get the current Palzin APM instance using the helper function or the Facade:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-php\"}),`/*\n * Using the helper function\n */\nultimate()-\u003eaddSegment(function () {\n    // Do something\n}, 'label');\n\n\n\n/*\n * Using the Facade\n */\n\\\\Ultimate\\\\Laravel\\\\Facades\\\\Ultimate::addSegment(function () {\n    // Do something\n}, 'label');\n`)),mdx(\"p\",null,\"The current Palzin APM instance is binded in the Laravel service container. In your controller, you can type-hint an argument with the Ultimate's class name.\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-php\"}),`namespace App\\\\Http\\\\Controllers;\n\nuse Illuminate\\\\Http\\\\Request;\nuse Ultimate\\\\Laravel\\\\Ultimate;\n\nclass HomeController extends Controller\n{\n    /**\n     * Show the application dashboard.\n     *\n     * @return \\\\Illuminate\\\\Contracts\\\\Support\\\\Renderable\n     */\n    public function index(Ultimate $ultimate)\n    {\n        return view('home');\n    }\n}\n`)))}MDXContent.isMDXComponent=!0;\n","scope":{"part":"Palzin APM","title":"Installation \u0026 Set-up","description":"Connect your Laravel application with Ultimate.","tocRaw":[{"content":"Server requirements","slug":"server-requirements","lvl":3,"i":0,"seen":0},{"content":"Clear the Laravel configuration","slug":"clear-the-laravel-configuration","lvl":3,"i":1,"seen":0},{"content":"Install","slug":"install","lvl":3,"i":2,"seen":0},{"content":"For Lumen","slug":"for-lumen","lvl":3,"i":3,"seen":0},{"content":"Configure the Ingestion Key","slug":"configure-the-ingestion-key","lvl":3,"i":4,"seen":0},{"content":"Test everything is working","slug":"test-everything-is-working","lvl":3,"i":5,"seen":0},{"content":"Reporting Out Of Memory Errors","slug":"reporting-out-of-memory-errors","lvl":3,"i":6,"seen":0},{"content":"Before flush callback","slug":"before-flush-callback","lvl":2,"i":7,"seen":0},{"content":"Sampling a specific transaction","slug":"sampling-a-specific-transaction","lvl":3,"i":8,"seen":0},{"content":"Set a custom service name","slug":"set-a-custom-service-name","lvl":3,"i":9,"seen":0},{"content":"Access the Palzin APM instance","slug":"access-the-palzin-apm-instance","lvl":2,"i":10,"seen":0}]}},"frontMatter":{"part":"Palzin APM","title":"Installation \u0026 Set-up","description":"Connect your Laravel application with Ultimate.","tocRaw":[{"content":"Server requirements","slug":"server-requirements","lvl":3,"i":0,"seen":0},{"content":"Clear the Laravel configuration","slug":"clear-the-laravel-configuration","lvl":3,"i":1,"seen":0},{"content":"Install","slug":"install","lvl":3,"i":2,"seen":0},{"content":"For Lumen","slug":"for-lumen","lvl":3,"i":3,"seen":0},{"content":"Configure the Ingestion Key","slug":"configure-the-ingestion-key","lvl":3,"i":4,"seen":0},{"content":"Test everything is working","slug":"test-everything-is-working","lvl":3,"i":5,"seen":0},{"content":"Reporting Out Of Memory Errors","slug":"reporting-out-of-memory-errors","lvl":3,"i":6,"seen":0},{"content":"Before flush callback","slug":"before-flush-callback","lvl":2,"i":7,"seen":0},{"content":"Sampling a specific transaction","slug":"sampling-a-specific-transaction","lvl":3,"i":8,"seen":0},{"content":"Set a custom service name","slug":"set-a-custom-service-name","lvl":3,"i":9,"seen":0},{"content":"Access the Palzin APM instance","slug":"access-the-palzin-apm-instance","lvl":2,"i":10,"seen":0}]}},"__N_SSG":true},"page":"/[part]/[page]","query":{"part":"laravel","page":"install-guide"},"buildId":"bTUou9AZlpBHxSxdWGLVM","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>