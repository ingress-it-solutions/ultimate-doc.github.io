{"pageProps":{"source":{"compiledSource":"var c=Object.defineProperty,h=Object.defineProperties;var d=Object.getOwnPropertyDescriptors;var r=Object.getOwnPropertySymbols;var o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;var l=(t,a,n)=>a in t?c(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,e=(t,a)=>{for(var n in a||(a={}))o.call(a,n)&&l(t,n,a[n]);if(r)for(var n of r(a))s.call(a,n)&&l(t,n,a[n]);return t},p=(t,a)=>h(t,d(a));var m=(t,a)=>{var n={};for(var i in t)o.call(t,i)&&a.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&r)for(var i of r(t))a.indexOf(i)<0&&s.call(t,i)&&(n[i]=t[i]);return n};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(n){var i=n,{components:t}=i,a=m(i,[\"components\"]);return mdx(MDXLayout,p(e(e({},layoutProps),a),{components:t,mdxType:\"MDXLayout\"}),mdx(\"hr\",null),mdx(\"h3\",e({},{id:\"what-are-segments\"}),\"What are segments?\"),mdx(\"p\",null,\"Segments represents the tasks performed during the current execution cycle.\"),mdx(\"p\",null,\"Thanks to Palzin APM you are able to put everything you want in your transaction's timeline getting a real-time feedback about the execution of a custom code block inside your app:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"Http call to external services (webhooks, integration, etc.)\"),mdx(\"li\",{parentName:\"ul\"},\"Functions that deal with files (pdf, excel, images)\"),mdx(\"li\",{parentName:\"ul\"},\"Data manipulation processes (import/export, data aggregation, etc.)\")),mdx(\"p\",null,\"and anything else you think is relevant to monitor how your application is behaving.\"),mdx(\"h3\",e({},{id:\"add-segments-short-form\"}),\"Add Segments (short form)\"),mdx(\"p\",null,\"This is the most easy way to wrap a code block into a segment:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-php\"}),`$ultimate->addSegment(function () {\n    \n    // Code block that you want add to the transaction timeline.\n    // DB queries, http calls, etc.\n    \n}, 'type', 'label');\n`)),mdx(\"p\",null,\"The code block inside the callback will be transparently executed, and your script will continue its execution normally. Palzin APM will works under the hood to profile execution performance.\"),mdx(\"p\",null,\"Here is an example of how the segment will appear in the timeline:\"),mdx(\"p\",null,mdx(\"img\",e({parentName:\"p\"},{src:\"/images/timeline.png\",alt:\"Timeline\"})),\" \"),mdx(\"p\",null,\"As showed in the example above a new segment is built with two input parameters:\"),mdx(\"table\",null,mdx(\"thead\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"thead\"},mdx(\"th\",e({parentName:\"tr\"},{align:\"left\"}),\"Parameter\"),mdx(\"th\",e({parentName:\"tr\"},{align:\"left\"}),\"Required\"),mdx(\"th\",e({parentName:\"tr\"},{align:\"left\"}),\"Description\"))),mdx(\"tbody\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:\"left\"}),\"type\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"left\"}),\"YES\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"left\"}),\"This is the master category of your segments\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:\"left\"}),\"label\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"left\"}),\"NO\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"left\"}),\"Human readable label or specific task's name that will be used as label inside the timeline. Otherwise type is used.\")))),mdx(\"p\",null,\"Think about how database queries is reported. There is one master category like mysql but each query has its own custom label that simply is an extract of the sql code.\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"mysql: master type\"),mdx(\"li\",{parentName:\"ul\"},\"select * from table: task name\")),mdx(\"p\",null,\"In this way you can mark toghether the statements related to the same topic or service, using something like mysql as type parameter and use the specific query string or task name as label for each statements of this type.\"),mdx(\"h3\",e({},{id:\"add-segments-extended-code\"}),\"Add Segments (extended code)\"),mdx(\"p\",null,\"You can use startSegment() method on the Palzin APM instance to manually control the monitoring of a code block:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-php\"}),`/* \n * Create a new \"segment\" that will be automatically attached \n * to the current transaction.\n */\n$segment = $ultimate->startSegment('type', 'label');\n\ntry {\n\n    /*\n     * Here is your code\n     */\n\n} catch(UnauthorizedException $exception) {\n\n    /*\n     * Report the exception to Palzin APM for diagnosis purpose.\n     */\n    $ultimate->reportException($exception);\n    \n} finally {\n    /*\n     * Close the code block with end() method to stop monitoring.\n     */\n    $segment->end();\n}\n`)),mdx(\"p\",null,\"As you can see in the example above we use try/catch/finally to be sure that your code block is monitored in a consistent way.\"),mdx(\"p\",null,\"Or you can use addSegment() that implements this strategy for you as seen above:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-php\"}),`$ultimate->addSegment(function () {\n    \n    /*\n     * Write here your code block\n     */\n     \n}, 'type', 'label');\n`)),mdx(\"p\",null,mdx(\"img\",e({parentName:\"p\"},{src:\"/images/timeline.png\",alt:\"Timeline\"}))),mdx(\"h3\",e({},{id:\"segments-tips-and-tricks\"}),\"Segments tips and tricks\"),mdx(\"p\",null,\"It may happen that you aren't able to wrap directly the statement to trace performance, so it might be useful to add a segment after the task has been executed. \"),mdx(\"p\",null,\"In this case you can create the segment manually passing the start time in the start() method, and the duration in the end() method, as shown in the example below:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-php\"}),`/*\n * Http call to an external url could be perfromed with following result.\n */\n$url = 'https://www.ultimate.dev';\n$duration_ms = 10; // Duration in milliseconds\n\n/** \n * -----------------------------------------\n * Create the segment manually setting timing information.\n * -----------------------------------------\n */\n\n// convert duration in seconds\n$timespamp_start = microtime(true) - ($duration_ms/1000) \n\n$ultimate->startSegment('api', $url)\n    ->start($timespamp_start)\n    ->end($duration_ms);\n\n`)),mdx(\"h3\",e({},{id:\"access-the-palzin-apm-instance\"}),\"Access the Palzin APM instance\"),mdx(\"p\",null,\"If you are using a framework specific library (Laravel, Symfony) you have several options to access the current Palzin APM instance to call addSegment() method. Check it out on their specific documetation:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{href:\"https://github.com/ingress-it-solutions/ultimate-laravel\",target:\"_blank\",rel:\"nofollow noopener noreferrer\"}),\"Laravel\"))))}MDXContent.isMDXComponent=!0;\n","scope":{"part":"Palzin APM","title":"Custom Segments","description":"Monitor custom code blocks inside your application.","tocRaw":[{"content":"What are segments?","slug":"what-are-segments","lvl":3,"i":0,"seen":0},{"content":"Add Segments (short form)","slug":"add-segments-short-form","lvl":3,"i":1,"seen":0},{"content":"Add Segments (extended code)","slug":"add-segments-extended-code","lvl":3,"i":2,"seen":0},{"content":"Segments tips and tricks","slug":"segments-tips-and-tricks","lvl":3,"i":3,"seen":0},{"content":"Access the Palzin APM instance","slug":"access-the-palzin-apm-instance","lvl":3,"i":4,"seen":0}]}},"frontMatter":{"part":"Palzin APM","title":"Custom Segments","description":"Monitor custom code blocks inside your application.","tocRaw":[{"content":"What are segments?","slug":"what-are-segments","lvl":3,"i":0,"seen":0},{"content":"Add Segments (short form)","slug":"add-segments-short-form","lvl":3,"i":1,"seen":0},{"content":"Add Segments (extended code)","slug":"add-segments-extended-code","lvl":3,"i":2,"seen":0},{"content":"Segments tips and tricks","slug":"segments-tips-and-tricks","lvl":3,"i":3,"seen":0},{"content":"Access the Palzin APM instance","slug":"access-the-palzin-apm-instance","lvl":3,"i":4,"seen":0}]}},"__N_SSG":true}