<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><title>Custom Segments - Palzin APM | Palzin APM</title><meta name="robots" content="index,follow"/><meta name="description" content="Monitor custom code blocks inside your application."/><meta property="og:title" content="Custom Segments"/><meta property="og:description" content="Monitor custom code blocks inside your application."/><meta property="og:url" content="https://next-book.vercel.app"/><meta property="og:type" content="website"/><meta content="width=device-width, initial-scale=1.0, maximum-scale=5.0" name="viewport"/><link rel="icon" href="/favicon.ico"/><link rel="icon" href="/icon.svg" type="image/svg+xml"/><link rel="apple-touch-icon" href="/512.png"/><link rel="manifest" href="/manifest.json"/><meta name="next-head-count" content="13"/><link rel="preload" href="/_next/static/css/61510affad946eec.css" as="style"/><link rel="stylesheet" href="/_next/static/css/61510affad946eec.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-9b312e20a4e32339.js" defer=""></script><script src="/_next/static/chunks/framework-91d7f78b5b4003c8.js" defer=""></script><script src="/_next/static/chunks/main-83803dd478f5b5bc.js" defer=""></script><script src="/_next/static/chunks/pages/_app-1416bd64c72df7dd.js" defer=""></script><script src="/_next/static/chunks/239-8a9b2939eaea8e23.js" defer=""></script><script src="/_next/static/chunks/133-66f115dc05b5dc1c.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bpart%5D/%5Bpage%5D-c55eb70027a9402d.js" defer=""></script><script src="/_next/static/j9sStjkacOZpVTt6IP2ph/_buildManifest.js" defer=""></script><script src="/_next/static/j9sStjkacOZpVTt6IP2ph/_ssgManifest.js" defer=""></script><script src="/_next/static/j9sStjkacOZpVTt6IP2ph/_middlewareManifest.js" defer=""></script></head><body class="bg-gray-200 dark:bg-gray-800 text-gray-700 dark:text-gray-200"><div id="__next" data-reactroot=""><header class="m-header z-40 md:shadow-md bg-gray-200 dark:bg-gray-800 fixed w-screen top-0 h-10 md:h-14 font-medium"><div class="logo-holder flex"><div class="flex pt-1 text-xs lg:text-sm nav-bar"><div class="flex ml-1 items-center md:hidden"><button title="Toggle mobile sidebar" class="shadow bg-gray-100 text-gray-600 dark:text-gray-400 dark:bg-gray-700 rounded p-1 focus:outline-none w-8 h-8"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg></button></div><div class="img-holder flex"><img src="/palzin-apm.png"/></div><nav class="text-left text-xs lg:text-sm pt-1 flex-auto space-x-1"><a class="border border-transparent hover:bg-gray-300 hover:text-gray-700 dark:hover:bg-gray-600
               dark:hover:text-gray-50 px-2 py-2 rounded-md font-medium hidden md:inline-block dark:text-gray-300 text-gray-600" href="/intro">Home</a><a class="border border-transparent hover:bg-gray-300 hover:text-gray-700 dark:hover:bg-gray-600
               dark:hover:text-gray-50 px-2 py-2 rounded-md font-medium hidden md:inline-block dark:bg-gray-700 dark:text-gray-50 bg-gray-300 text-gray-700" href="/php/introduction">PHP</a><a class="border border-transparent hover:bg-gray-300 hover:text-gray-700 dark:hover:bg-gray-600
               dark:hover:text-gray-50 px-2 py-2 rounded-md font-medium hidden md:inline-block dark:text-gray-300 text-gray-600" href="/laravel/introduction">Laravel/Lumen</a><a class="border border-transparent hover:bg-gray-300 hover:text-gray-700 dark:hover:bg-gray-600
               dark:hover:text-gray-50 px-2 py-2 rounded-md font-medium hidden md:inline-block dark:text-gray-300 text-gray-600" href="https://github.com/amiroff/NextBook">Github</a></nav><div class="flex items-center space-x-2"><button title="Toggle dark mode (T)" class="shadow bg-gray-100 text-gray-600 dark:text-gray-400 dark:bg-gray-700 rounded p-1 mr-1 md:mr-7 focus:outline-none w-8 h-8"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg></button></div></div></div></header><div class="content-wrapper mt-10 md:mt-14 flex xl:container xl:mx-auto"><aside class="sidebar z-50 flex-none md:w-56 xl:w-64 h-screen fixed top-10 md:top-14 hidden md:block"><div class="w-full pb-40 md:pb-16 h-full overflow-y-auto pr-6 "><div class="flex flex-col md:mt-10"><a aria-label="Palzin APM" href="/"><div class="flex flex-col items-center"><span class="hidden text-center md:inline-block font-semibold " title="Palzin APM">Palzin APM</span></div></a><div class="mt-6 pl-2 leading-loose tracking-wide"><div><a class="flex items-center font-normal pl-2 my-1 rounded hover:bg-gray-300 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-50" href="/intro"><span class="text-gray-500 dark:text-gray-300"><svg viewBox="0 0 16 16" fill="currentColor" class="w-3"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8z"></path></svg></span><span class="pl-2">Welcome to Palzin APM</span></a></div><div class="flex font-medium my-2 ml-2 items-center"><div class="text-gray-400 dark:text-gray-400"><svg height="16px" class="sidebar-title-icon" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></div><div class="pl-2 cursor-pointer select-none">PHP</div></div><div class="hidden"><a class="flex items-center font-normal pl-2 my-1 rounded hover:bg-gray-300 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-50" href="/php/introduction"><span class="text-gray-500 dark:text-gray-300"><svg viewBox="0 0 16 16" fill="currentColor" class="w-3"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8z"></path></svg></span><span class="pl-2">Introduction</span></a><a class="flex items-center font-normal pl-2 my-1 rounded hover:bg-gray-300 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-50" href="/php/upgrade-guide"><span class="text-gray-500 dark:text-gray-300"><svg viewBox="0 0 16 16" fill="currentColor" class="w-3"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8z"></path></svg></span><span class="pl-2">Upgrade Guide</span></a><a class="flex items-center font-normal pl-2 my-1 rounded hover:bg-gray-300 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-50" href="/php/install-guide"><span class="text-gray-500 dark:text-gray-300"><svg viewBox="0 0 16 16" fill="currentColor" class="w-3"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8z"></path></svg></span><span class="pl-2">Installation</span></a><a class="flex items-center font-normal pl-2 my-1 rounded hover:bg-gray-300 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-50" href="/php/usage"><span class="text-gray-500 dark:text-gray-300"><svg viewBox="0 0 16 16" fill="currentColor" class="w-3"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8z"></path></svg></span><span class="pl-2">Usage</span></a><a class="flex items-center font-normal pl-2 my-1 rounded hover:bg-gray-300 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-50" href="/php/configuration"><span class="text-gray-500 dark:text-gray-300"><svg viewBox="0 0 16 16" fill="currentColor" class="w-3"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8z"></path></svg></span><span class="pl-2">Configuration</span></a><a class="flex items-center font-normal pl-2 my-1 rounded hover:bg-gray-300 dark:hover:bg-gray-700 text-gray-900 dark:text-gray-50 bg-gray-300 dark:bg-gray-700" href="/php/custom-segment"><span class="text-gray-900 dark:text-gray-50"><svg viewBox="0 0 16 16" fill="currentColor" class="w-3"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8z"></path></svg></span><span class="pl-2">Custom Segments</span></a><a class="flex items-center font-normal pl-2 my-1 rounded hover:bg-gray-300 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-50" href="/php/exception"><span class="text-gray-500 dark:text-gray-300"><svg viewBox="0 0 16 16" fill="currentColor" class="w-3"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8z"></path></svg></span><span class="pl-2">Exceptions Monitoring</span></a></div><div class="flex font-medium my-2 ml-2 items-center"><div class="text-gray-400 dark:text-gray-400"><svg height="16px" class="sidebar-title-icon" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></div><div class="pl-2 cursor-pointer select-none">Laravel/Lumen</div></div><div class="hidden"><a class="flex items-center font-normal pl-2 my-1 rounded hover:bg-gray-300 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-50" href="/laravel/introduction"><span class="text-gray-500 dark:text-gray-300"><svg viewBox="0 0 16 16" fill="currentColor" class="w-3"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8z"></path></svg></span><span class="pl-2">Introduction</span></a><a class="flex items-center font-normal pl-2 my-1 rounded hover:bg-gray-300 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-50" href="/laravel/upgrade-guide"><span class="text-gray-500 dark:text-gray-300"><svg viewBox="0 0 16 16" fill="currentColor" class="w-3"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8z"></path></svg></span><span class="pl-2">Upgrade Guide</span></a><a class="flex items-center font-normal pl-2 my-1 rounded hover:bg-gray-300 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-50" href="/laravel/install-guide"><span class="text-gray-500 dark:text-gray-300"><svg viewBox="0 0 16 16" fill="currentColor" class="w-3"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8z"></path></svg></span><span class="pl-2">Installation</span></a><a class="flex items-center font-normal pl-2 my-1 rounded hover:bg-gray-300 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-50" href="/laravel/usage"><span class="text-gray-500 dark:text-gray-300"><svg viewBox="0 0 16 16" fill="currentColor" class="w-3"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8z"></path></svg></span><span class="pl-2">Http Requests Monitoring</span></a><a class="flex items-center font-normal pl-2 my-1 rounded hover:bg-gray-300 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-50" href="/laravel/configuration"><span class="text-gray-500 dark:text-gray-300"><svg viewBox="0 0 16 16" fill="currentColor" class="w-3"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8z"></path></svg></span><span class="pl-2">Configuration</span></a><a class="flex items-center font-normal pl-2 my-1 rounded hover:bg-gray-300 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-50" href="/laravel/exception"><span class="text-gray-500 dark:text-gray-300"><svg viewBox="0 0 16 16" fill="currentColor" class="w-3"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8z"></path></svg></span><span class="pl-2">Exceptions Monitoring</span></a></div></div></div></div></aside><div class="md-wrapper flex md:ml-56 xl:ml-64"><div class="content-container flex"><div class="content px-4 md:px-8 w-screen max-w-screen-sm md:max-w-screen-md xl:max-w-screen-md 2xl:max-w-screen-lg"><h1 class="text-4xl font-bold my-5">Custom Segments</h1><p class="my-1">Monitor custom code blocks inside your application.</p><div class="md-content"><hr class="my-3 mx-1 border-gray-300 dark:border-gray-600"/><div class="font-semibold my-5 text-3xl"><h3 id="what-are-segments" class="inline-block">What are segments?</h3><span class="hidden md:inline-block m-1 text-sm 2xl:text-base cursor-pointer text-transparent hover:text-gray-400" title="Copy link to this heading" aria-hidden="true">¶</span></div><p>Segments represents the tasks performed during the current execution cycle.</p><p>Thanks to Palzin APM you are able to put everything you want in your transaction&#x27;s timeline getting a real-time feedback about the execution of a custom code block inside your app:</p><ul class="ml-6 list-outside list-disc leading-7"><li>Http call to external services (webhooks, integration, etc.)</li><li>Functions that deal with files (pdf, excel, images)</li><li>Data manipulation processes (import/export, data aggregation, etc.)</li></ul><p>and anything else you think is relevant to monitor how your application is behaving.</p><div class="font-semibold my-5 text-3xl"><h3 id="add-segments-short-form" class="inline-block">Add Segments (short form)</h3><span class="hidden md:inline-block m-1 text-sm 2xl:text-base cursor-pointer text-transparent hover:text-gray-400" title="Copy link to this heading" aria-hidden="true">¶</span></div><p>This is the most easy way to wrap a code block into a segment:</p><pre><div class="clean"><div class="relative h-0"><button class="no-print absolute top-1 right-1 rounded w-7 h-7 p-1 z-10 text-gray-500 dark:bg-gray-900 dark:text-gray-400 focus:outline-none" title="Copy to clipboard"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path></svg></button></div><pre class="text-sm 2xl:text-base overflow-x-auto py-3 my-4 
                           rounded dark:bg-gray-900 dark:text-gray-200
    bg-gray-50 text-gray-900 mt-4"><code class="" style="white-space:pre"><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">1</span><span class="token token" style="color:#e53935">$ultimate</span><span class="token token" style="color:#39adb5">-&gt;</span><span class="token token" style="color:#7c4dff">addSegment</span><span class="token token" style="color:#39adb5">(</span><span class="token token" style="color:#7c4dff">function</span><span> </span><span class="token token" style="color:#39adb5">(</span><span class="token token" style="color:#39adb5">)</span><span> </span><span class="token token" style="color:#39adb5">{</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">2</span>    
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">3</span><span>    </span><span class="token token" style="color:#aabfc9">// Code block that you want add to the transaction timeline.</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">4</span><span>    </span><span class="token token" style="color:#aabfc9">// DB queries, http calls, etc.</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">5</span>    
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">6</span><span></span><span class="token token" style="color:#39adb5">}</span><span class="token token" style="color:#39adb5">,</span><span> </span><span class="token token single-quoted-string" style="color:#f6a434">&#x27;type&#x27;</span><span class="token token" style="color:#39adb5">,</span><span> </span><span class="token token single-quoted-string" style="color:#f6a434">&#x27;label&#x27;</span><span class="token token" style="color:#39adb5">)</span><span class="token token" style="color:#39adb5">;</span></span></code></pre></div></pre><p>The code block inside the callback will be transparently executed, and your script will continue its execution normally. Palzin APM will works under the hood to profile execution performance.</p><p>Here is an example of how the segment will appear in the timeline:</p><p><img class="object-scale-down block rounded " src="/images/timeline.png" alt="Timeline"/><span class="block m-1 md:m-2"><span class="font-semibold">Screen shot</span>:<!-- --> <!-- -->Timeline</span> </p><p>As showed in the example above a new segment is built with two input parameters:</p><table class="table-auto my-4"><thead class="tracking-wider text-sm 2xl:text-base font-medium uppercase"><tr class="border border-gray-400 dark:border-gray-600 p-2"><th class="border border-gray-400 p-2 font-semibold bg-gray-300 dark:bg-gray-600 dark:border-gray-500" align="left">Parameter</th><th class="border border-gray-400 p-2 font-semibold bg-gray-300 dark:bg-gray-600 dark:border-gray-500" align="left">Required</th><th class="border border-gray-400 p-2 font-semibold bg-gray-300 dark:bg-gray-600 dark:border-gray-500" align="left">Description</th></tr></thead><tbody class="text-sm 2xl:text-base"><tr class="border border-gray-400 dark:border-gray-600 p-2"><td class="border border-gray-400 dark:border-gray-600 p-2" align="left">type</td><td class="border border-gray-400 dark:border-gray-600 p-2" align="left">YES</td><td class="border border-gray-400 dark:border-gray-600 p-2" align="left">This is the master category of your segments</td></tr><tr class="border border-gray-400 dark:border-gray-600 p-2"><td class="border border-gray-400 dark:border-gray-600 p-2" align="left">label</td><td class="border border-gray-400 dark:border-gray-600 p-2" align="left">NO</td><td class="border border-gray-400 dark:border-gray-600 p-2" align="left">Human readable label or specific task&#x27;s name that will be used as label inside the timeline. Otherwise type is used.</td></tr></tbody></table><p>Think about how database queries is reported. There is one master category like mysql but each query has its own custom label that simply is an extract of the sql code.</p><ul class="ml-6 list-outside list-disc leading-7"><li>mysql: master type</li><li>select * from table: task name</li></ul><p>In this way you can mark toghether the statements related to the same topic or service, using something like mysql as type parameter and use the specific query string or task name as label for each statements of this type.</p><div class="font-semibold my-5 text-3xl"><h3 id="add-segments-extended-code" class="inline-block">Add Segments (extended code)</h3><span class="hidden md:inline-block m-1 text-sm 2xl:text-base cursor-pointer text-transparent hover:text-gray-400" title="Copy link to this heading" aria-hidden="true">¶</span></div><p>You can use startSegment() method on the Palzin APM instance to manually control the monitoring of a code block:</p><pre><div class="clean"><div class="relative h-0"><button class="no-print absolute top-1 right-1 rounded w-7 h-7 p-1 z-10 text-gray-500 dark:bg-gray-900 dark:text-gray-400 focus:outline-none" title="Copy to clipboard"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path></svg></button></div><pre class="text-sm 2xl:text-base overflow-x-auto py-3 my-4 
                           rounded dark:bg-gray-900 dark:text-gray-200
    bg-gray-50 text-gray-900 mt-4"><code class="" style="white-space:pre"><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">1</span><span class="token token" style="color:#aabfc9">/* 
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px;color:#aabfc9" class="token token"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">2</span> * Create a new &quot;segment&quot; that will be automatically attached 
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px;color:#aabfc9" class="token token"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">3</span> * to the current transaction.
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">4</span><span class="token token" style="color:#aabfc9"> */</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">5</span><span></span><span class="token token" style="color:#e53935">$segment</span><span> </span><span class="token token" style="color:#39adb5">=</span><span> </span><span class="token token" style="color:#e53935">$ultimate</span><span class="token token" style="color:#39adb5">-&gt;</span><span class="token token" style="color:#7c4dff">startSegment</span><span class="token token" style="color:#39adb5">(</span><span class="token token single-quoted-string" style="color:#f6a434">&#x27;type&#x27;</span><span class="token token" style="color:#39adb5">,</span><span> </span><span class="token token single-quoted-string" style="color:#f6a434">&#x27;label&#x27;</span><span class="token token" style="color:#39adb5">)</span><span class="token token" style="color:#39adb5">;</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">6</span>
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">7</span><span></span><span class="token token" style="color:#7c4dff">try</span><span> </span><span class="token token" style="color:#39adb5">{</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">8</span>
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">9</span><span>    </span><span class="token token" style="color:#aabfc9">/*
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px;color:#aabfc9" class="token token"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">10</span>     * Here is your code
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">11</span><span class="token token" style="color:#aabfc9">     */</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">12</span>
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">13</span><span></span><span class="token token" style="color:#39adb5">}</span><span> </span><span class="token token" style="color:#7c4dff">catch</span><span class="token token" style="color:#39adb5">(</span><span class="token token" style="color:#6182b8">UnauthorizedException</span><span> </span><span class="token token" style="color:#e53935">$exception</span><span class="token token" style="color:#39adb5">)</span><span> </span><span class="token token" style="color:#39adb5">{</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">14</span>
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">15</span><span>    </span><span class="token token" style="color:#aabfc9">/*
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px;color:#aabfc9" class="token token"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">16</span>     * Report the exception to Palzin APM for diagnosis purpose.
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">17</span><span class="token token" style="color:#aabfc9">     */</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">18</span><span>    </span><span class="token token" style="color:#e53935">$ultimate</span><span class="token token" style="color:#39adb5">-&gt;</span><span class="token token" style="color:#7c4dff">reportException</span><span class="token token" style="color:#39adb5">(</span><span class="token token" style="color:#e53935">$exception</span><span class="token token" style="color:#39adb5">)</span><span class="token token" style="color:#39adb5">;</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">19</span>    
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">20</span><span></span><span class="token token" style="color:#39adb5">}</span><span> </span><span class="token token" style="color:#7c4dff">finally</span><span> </span><span class="token token" style="color:#39adb5">{</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">21</span><span>    </span><span class="token token" style="color:#aabfc9">/*
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px;color:#aabfc9" class="token token"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">22</span>     * Close the code block with end() method to stop monitoring.
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">23</span><span class="token token" style="color:#aabfc9">     */</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">24</span><span>    </span><span class="token token" style="color:#e53935">$segment</span><span class="token token" style="color:#39adb5">-&gt;</span><span class="token token" style="color:#7c4dff">end</span><span class="token token" style="color:#39adb5">(</span><span class="token token" style="color:#39adb5">)</span><span class="token token" style="color:#39adb5">;</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">25</span><span></span><span class="token token" style="color:#39adb5">}</span></span></code></pre></div></pre><p>As you can see in the example above we use try/catch/finally to be sure that your code block is monitored in a consistent way.</p><p>Or you can use addSegment() that implements this strategy for you as seen above:</p><pre><div class="clean"><div class="relative h-0"><button class="no-print absolute top-1 right-1 rounded w-7 h-7 p-1 z-10 text-gray-500 dark:bg-gray-900 dark:text-gray-400 focus:outline-none" title="Copy to clipboard"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path></svg></button></div><pre class="text-sm 2xl:text-base overflow-x-auto py-3 my-4 
                           rounded dark:bg-gray-900 dark:text-gray-200
    bg-gray-50 text-gray-900 mt-4"><code class="" style="white-space:pre"><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">1</span><span class="token token" style="color:#e53935">$ultimate</span><span class="token token" style="color:#39adb5">-&gt;</span><span class="token token" style="color:#7c4dff">addSegment</span><span class="token token" style="color:#39adb5">(</span><span class="token token" style="color:#7c4dff">function</span><span> </span><span class="token token" style="color:#39adb5">(</span><span class="token token" style="color:#39adb5">)</span><span> </span><span class="token token" style="color:#39adb5">{</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">2</span>    
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">3</span><span>    </span><span class="token token" style="color:#aabfc9">/*
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px;color:#aabfc9" class="token token"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">4</span>     * Write here your code block
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">5</span><span class="token token" style="color:#aabfc9">     */</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">6</span>     
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">7</span><span></span><span class="token token" style="color:#39adb5">}</span><span class="token token" style="color:#39adb5">,</span><span> </span><span class="token token single-quoted-string" style="color:#f6a434">&#x27;type&#x27;</span><span class="token token" style="color:#39adb5">,</span><span> </span><span class="token token single-quoted-string" style="color:#f6a434">&#x27;label&#x27;</span><span class="token token" style="color:#39adb5">)</span><span class="token token" style="color:#39adb5">;</span></span></code></pre></div></pre><p><img class="object-scale-down block rounded " src="/images/timeline.png" alt="Timeline"/><span class="block m-1 md:m-2"><span class="font-semibold">Screen shot</span>:<!-- --> <!-- -->Timeline</span></p><div class="font-semibold my-5 text-3xl"><h3 id="segments-tips-and-tricks" class="inline-block">Segments tips and tricks</h3><span class="hidden md:inline-block m-1 text-sm 2xl:text-base cursor-pointer text-transparent hover:text-gray-400" title="Copy link to this heading" aria-hidden="true">¶</span></div><p>It may happen that you aren&#x27;t able to wrap directly the statement to trace performance, so it might be useful to add a segment after the task has been executed. </p><p>In this case you can create the segment manually passing the start time in the start() method, and the duration in the end() method, as shown in the example below:</p><pre><div class="clean"><div class="relative h-0"><button class="no-print absolute top-1 right-1 rounded w-7 h-7 p-1 z-10 text-gray-500 dark:bg-gray-900 dark:text-gray-400 focus:outline-none" title="Copy to clipboard"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path></svg></button></div><pre class="text-sm 2xl:text-base overflow-x-auto py-3 my-4 
                           rounded dark:bg-gray-900 dark:text-gray-200
    bg-gray-50 text-gray-900 mt-4"><code class="" style="white-space:pre"><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">1</span><span class="token token" style="color:#aabfc9">/*
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px;color:#aabfc9" class="token token"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">2</span> * Http call to an external url could be perfromed with following result.
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">3</span><span class="token token" style="color:#aabfc9"> */</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">4</span><span></span><span class="token token" style="color:#e53935">$url</span><span> </span><span class="token token" style="color:#39adb5">=</span><span> </span><span class="token token single-quoted-string" style="color:#f6a434">&#x27;https://www.ultimate.dev&#x27;</span><span class="token token" style="color:#39adb5">;</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">5</span><span></span><span class="token token" style="color:#e53935">$duration_ms</span><span> </span><span class="token token" style="color:#39adb5">=</span><span> </span><span class="token token" style="color:#f76d47">10</span><span class="token token" style="color:#39adb5">;</span><span> </span><span class="token token" style="color:#aabfc9">// Duration in milliseconds</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">6</span>
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">7</span><span></span><span class="token token doc-comment" style="color:#aabfc9">/** 
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px;color:#aabfc9" class="token token doc-comment"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">8</span> * -----------------------------------------
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px;color:#aabfc9" class="token token doc-comment"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">9</span> * Create the segment manually setting timing information.
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px;color:#aabfc9" class="token token doc-comment"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">10</span> * -----------------------------------------
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">11</span><span class="token token doc-comment" style="color:#aabfc9"> */</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">12</span>
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">13</span><span></span><span class="token token" style="color:#aabfc9">// convert duration in seconds</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">14</span><span></span><span class="token token" style="color:#e53935">$timespamp_start</span><span> </span><span class="token token" style="color:#39adb5">=</span><span> </span><span class="token token" style="color:#7c4dff">microtime</span><span class="token token" style="color:#39adb5">(</span><span class="token token" style="color:#7c4dff">true</span><span class="token token" style="color:#39adb5">)</span><span> </span><span class="token token" style="color:#39adb5">-</span><span> </span><span class="token token" style="color:#39adb5">(</span><span class="token token" style="color:#e53935">$duration_ms</span><span class="token token" style="color:#39adb5">/</span><span class="token token" style="color:#f76d47">1000</span><span class="token token" style="color:#39adb5">)</span><span> 
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">15</span>
</span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">16</span><span></span><span class="token token" style="color:#e53935">$ultimate</span><span class="token token" style="color:#39adb5">-&gt;</span><span class="token token" style="color:#7c4dff">startSegment</span><span class="token token" style="color:#39adb5">(</span><span class="token token single-quoted-string" style="color:#f6a434">&#x27;api&#x27;</span><span class="token token" style="color:#39adb5">,</span><span> </span><span class="token token" style="color:#e53935">$url</span><span class="token token" style="color:#39adb5">)</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">17</span><span>    </span><span class="token token" style="color:#39adb5">-&gt;</span><span class="token token" style="color:#7c4dff">start</span><span class="token token" style="color:#39adb5">(</span><span class="token token" style="color:#e53935">$timespamp_start</span><span class="token token" style="color:#39adb5">)</span><span>
</span></span><span style="border-left:3px solid transparent;display:block;padding-left:16px"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#aabfc9">18</span><span>    </span><span class="token token" style="color:#39adb5">-&gt;</span><span class="token token" style="color:#7c4dff">end</span><span class="token token" style="color:#39adb5">(</span><span class="token token" style="color:#e53935">$duration_ms</span><span class="token token" style="color:#39adb5">)</span><span class="token token" style="color:#39adb5">;</span></span></code></pre></div></pre><div class="font-semibold my-5 text-3xl"><h3 id="access-the-palzin-apm-instance" class="inline-block">Access the Palzin APM instance</h3><span class="hidden md:inline-block m-1 text-sm 2xl:text-base cursor-pointer text-transparent hover:text-gray-400" title="Copy link to this heading" aria-hidden="true">¶</span></div><p>If you are using a framework specific library (Laravel, Symfony) you have several options to access the current Palzin APM instance to call addSegment() method. Check it out on their specific documetation:</p><ul class="ml-6 list-outside list-disc leading-7"><li><a href="https://github.com/ingress-it-solutions/ultimate-laravel" target="_blank" rel="nofollow noopener noreferrer" class="underline">Laravel</a></li></ul></div><hr class="my-3 mx-1 print:hidden border-gray-300 dark:border-gray-600"/><div class="my-2 no-print"><div class="flex flex-col-reverse sm:flex-row false"><a class="border footer-link-option border-transparent w-full justify-center md:justify-between rounded m-1 p-3 bg-gray-300 text-gray-700 hover:border-gray-400 hover:text-gray-900 dark:bg-gray-700 dark:text-gray-200 dark:hover:border-gray-600 dark:hover:text-gray-100 false" title="Previous chapter (&lt;-)" href="/php/configuration"><span class="previous-tag">Previous</span><div class="flex w-full justify-center md:justify-between"><svg preserveAspectRatio="xMidYMid meet" height="1.6em" width="1.6em" fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor"><g><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></g></svg><div class="ml-2">Configuration</div></div></a><a class="border footer-link-option border-transparent w-full justify-center md:justify-between rounded m-1 p-3 bg-gray-300 text-gray-700 hover:border-gray-400 hover:text-gray-900 dark:bg-gray-700 dark:text-gray-200 dark:hover:border-gray-600 dark:hover:text-gray-100 false" title="Next chapter (-&gt;)" href="/php/exception"><span class="next-tag">Next</span><div class="flex w-full justify-center md:justify-between"><div class="mr-2">Exceptions Monitoring</div><svg preserveAspectRatio="xMidYMid meet" height="1.6em" width="1.6em" fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor"><g><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></g></svg></div></a></div></div></div><div class="toc-container flex-none w-56 hidden lg:block"><div class="toc sticky top-20"><div class="pr-2"><div class="content-toc-title font-medium rounded py-2"><svg height="18" viewBox="0 0 48 48" width="18" xmlns="http://www.w3.org/2000/svg"><path d="M6 42h36v-4h-36v4zm12-8h24v-4h-24v4zm-12-8h36v-4h-36v4zm12-8h24v-4h-24v4zm-12-12v4h36v-4h-36z"></path><path d="M0 0h48v48h-48z" fill="none"></path></svg><span>Contents</span></div><ul class="tracking-wide mt-4 text-gray-600 dark:text-gray-400 text-sm 2xl:text-base border-0 border-l border-gray-300 dark:border-gray-600 leading-6 cursor-pointer"></ul></div></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"source":{"compiledSource":"var c=Object.defineProperty,h=Object.defineProperties;var d=Object.getOwnPropertyDescriptors;var r=Object.getOwnPropertySymbols;var o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;var l=(t,a,n)=\u003ea in t?c(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,e=(t,a)=\u003e{for(var n in a||(a={}))o.call(a,n)\u0026\u0026l(t,n,a[n]);if(r)for(var n of r(a))s.call(a,n)\u0026\u0026l(t,n,a[n]);return t},p=(t,a)=\u003eh(t,d(a));var m=(t,a)=\u003e{var n={};for(var i in t)o.call(t,i)\u0026\u0026a.indexOf(i)\u003c0\u0026\u0026(n[i]=t[i]);if(t!=null\u0026\u0026r)for(var i of r(t))a.indexOf(i)\u003c0\u0026\u0026s.call(t,i)\u0026\u0026(n[i]=t[i]);return n};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(n){var i=n,{components:t}=i,a=m(i,[\"components\"]);return mdx(MDXLayout,p(e(e({},layoutProps),a),{components:t,mdxType:\"MDXLayout\"}),mdx(\"hr\",null),mdx(\"h3\",e({},{id:\"what-are-segments\"}),\"What are segments?\"),mdx(\"p\",null,\"Segments represents the tasks performed during the current execution cycle.\"),mdx(\"p\",null,\"Thanks to Palzin APM you are able to put everything you want in your transaction's timeline getting a real-time feedback about the execution of a custom code block inside your app:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"Http call to external services (webhooks, integration, etc.)\"),mdx(\"li\",{parentName:\"ul\"},\"Functions that deal with files (pdf, excel, images)\"),mdx(\"li\",{parentName:\"ul\"},\"Data manipulation processes (import/export, data aggregation, etc.)\")),mdx(\"p\",null,\"and anything else you think is relevant to monitor how your application is behaving.\"),mdx(\"h3\",e({},{id:\"add-segments-short-form\"}),\"Add Segments (short form)\"),mdx(\"p\",null,\"This is the most easy way to wrap a code block into a segment:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-php\"}),`$ultimate-\u003eaddSegment(function () {\n    \n    // Code block that you want add to the transaction timeline.\n    // DB queries, http calls, etc.\n    \n}, 'type', 'label');\n`)),mdx(\"p\",null,\"The code block inside the callback will be transparently executed, and your script will continue its execution normally. Palzin APM will works under the hood to profile execution performance.\"),mdx(\"p\",null,\"Here is an example of how the segment will appear in the timeline:\"),mdx(\"p\",null,mdx(\"img\",e({parentName:\"p\"},{src:\"/images/timeline.png\",alt:\"Timeline\"})),\" \"),mdx(\"p\",null,\"As showed in the example above a new segment is built with two input parameters:\"),mdx(\"table\",null,mdx(\"thead\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"thead\"},mdx(\"th\",e({parentName:\"tr\"},{align:\"left\"}),\"Parameter\"),mdx(\"th\",e({parentName:\"tr\"},{align:\"left\"}),\"Required\"),mdx(\"th\",e({parentName:\"tr\"},{align:\"left\"}),\"Description\"))),mdx(\"tbody\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:\"left\"}),\"type\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"left\"}),\"YES\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"left\"}),\"This is the master category of your segments\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:\"left\"}),\"label\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"left\"}),\"NO\"),mdx(\"td\",e({parentName:\"tr\"},{align:\"left\"}),\"Human readable label or specific task's name that will be used as label inside the timeline. Otherwise type is used.\")))),mdx(\"p\",null,\"Think about how database queries is reported. There is one master category like mysql but each query has its own custom label that simply is an extract of the sql code.\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"mysql: master type\"),mdx(\"li\",{parentName:\"ul\"},\"select * from table: task name\")),mdx(\"p\",null,\"In this way you can mark toghether the statements related to the same topic or service, using something like mysql as type parameter and use the specific query string or task name as label for each statements of this type.\"),mdx(\"h3\",e({},{id:\"add-segments-extended-code\"}),\"Add Segments (extended code)\"),mdx(\"p\",null,\"You can use startSegment() method on the Palzin APM instance to manually control the monitoring of a code block:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-php\"}),`/* \n * Create a new \"segment\" that will be automatically attached \n * to the current transaction.\n */\n$segment = $ultimate-\u003estartSegment('type', 'label');\n\ntry {\n\n    /*\n     * Here is your code\n     */\n\n} catch(UnauthorizedException $exception) {\n\n    /*\n     * Report the exception to Palzin APM for diagnosis purpose.\n     */\n    $ultimate-\u003ereportException($exception);\n    \n} finally {\n    /*\n     * Close the code block with end() method to stop monitoring.\n     */\n    $segment-\u003eend();\n}\n`)),mdx(\"p\",null,\"As you can see in the example above we use try/catch/finally to be sure that your code block is monitored in a consistent way.\"),mdx(\"p\",null,\"Or you can use addSegment() that implements this strategy for you as seen above:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-php\"}),`$ultimate-\u003eaddSegment(function () {\n    \n    /*\n     * Write here your code block\n     */\n     \n}, 'type', 'label');\n`)),mdx(\"p\",null,mdx(\"img\",e({parentName:\"p\"},{src:\"/images/timeline.png\",alt:\"Timeline\"}))),mdx(\"h3\",e({},{id:\"segments-tips-and-tricks\"}),\"Segments tips and tricks\"),mdx(\"p\",null,\"It may happen that you aren't able to wrap directly the statement to trace performance, so it might be useful to add a segment after the task has been executed. \"),mdx(\"p\",null,\"In this case you can create the segment manually passing the start time in the start() method, and the duration in the end() method, as shown in the example below:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-php\"}),`/*\n * Http call to an external url could be perfromed with following result.\n */\n$url = 'https://www.ultimate.dev';\n$duration_ms = 10; // Duration in milliseconds\n\n/** \n * -----------------------------------------\n * Create the segment manually setting timing information.\n * -----------------------------------------\n */\n\n// convert duration in seconds\n$timespamp_start = microtime(true) - ($duration_ms/1000) \n\n$ultimate-\u003estartSegment('api', $url)\n    -\u003estart($timespamp_start)\n    -\u003eend($duration_ms);\n\n`)),mdx(\"h3\",e({},{id:\"access-the-palzin-apm-instance\"}),\"Access the Palzin APM instance\"),mdx(\"p\",null,\"If you are using a framework specific library (Laravel, Symfony) you have several options to access the current Palzin APM instance to call addSegment() method. Check it out on their specific documetation:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{href:\"https://github.com/ingress-it-solutions/ultimate-laravel\",target:\"_blank\",rel:\"nofollow noopener noreferrer\"}),\"Laravel\"))))}MDXContent.isMDXComponent=!0;\n","scope":{"part":"Palzin APM","title":"Custom Segments","description":"Monitor custom code blocks inside your application.","tocRaw":[{"content":"What are segments?","slug":"what-are-segments","lvl":3,"i":0,"seen":0},{"content":"Add Segments (short form)","slug":"add-segments-short-form","lvl":3,"i":1,"seen":0},{"content":"Add Segments (extended code)","slug":"add-segments-extended-code","lvl":3,"i":2,"seen":0},{"content":"Segments tips and tricks","slug":"segments-tips-and-tricks","lvl":3,"i":3,"seen":0},{"content":"Access the Palzin APM instance","slug":"access-the-palzin-apm-instance","lvl":3,"i":4,"seen":0}]}},"frontMatter":{"part":"Palzin APM","title":"Custom Segments","description":"Monitor custom code blocks inside your application.","tocRaw":[{"content":"What are segments?","slug":"what-are-segments","lvl":3,"i":0,"seen":0},{"content":"Add Segments (short form)","slug":"add-segments-short-form","lvl":3,"i":1,"seen":0},{"content":"Add Segments (extended code)","slug":"add-segments-extended-code","lvl":3,"i":2,"seen":0},{"content":"Segments tips and tricks","slug":"segments-tips-and-tricks","lvl":3,"i":3,"seen":0},{"content":"Access the Palzin APM instance","slug":"access-the-palzin-apm-instance","lvl":3,"i":4,"seen":0}]}},"__N_SSG":true},"page":"/[part]/[page]","query":{"part":"php","page":"custom-segment"},"buildId":"j9sStjkacOZpVTt6IP2ph","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>